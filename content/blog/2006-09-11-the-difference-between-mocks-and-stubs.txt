--- 
permalink: the-difference-between-mocks-and-stubs
updated_at: 2006-09-11 08:05:17 +00:00
guid: ac0cff8e-8238-4234-87e7-16fd6739d5b6
title: The Difference between Mocks and Stubs
id: 84
filter: 
- erb
- textile
categories: []

layout: blog
created_at: 2006-09-11 03:57:15 +00:00
keywords: ruby difference mock stub expectation mocha stubba testing mocking stubbing
---
Some recent converstations have made me realise that a lot of people are confused by the difference between mocking and stubbing. I've realised that I've only added to the confusion by calling part of the "Mocha":http://mocha.rubyforge.com library, Stubba.

*The difference between mocking and stubbing*

Stubbing a method is all about replacing the method with code that returns a specified result (or perhaps raises a specified exception). Mocking a method is all about asserting that a method has been called (perhaps with particular parameters).

If you think about it, it's difficult (or impossible?) to do mocking without stubbing - you need to return from the mocked method, so that the code under test can complete execution. So mocking libraries tend to implicitly or explicitly allow you to do stubbing.

*Mocking and stubbing with Mocha*

To stub a method, use the "stubs":http://mocha.rubyforge.org/classes/Mocha/MockMethods.html#M000006 method.
To mock a method, use the "expects":http://mocha.rubyforge.org/classes/Mocha/MockMethods.html#M000005 method.

*The difference between Mocha and Stubba*

"Mocha":http://mocha.rubyforge.com is a traditional mocking library very much in the "JMock":http://www.jmock.org mould. Stubba is a separate part of Mocha that allows mocking *and* stubbing of methods on real (non-mock) classes. It works by moving the method of interest to one side, adding a new stubbed version of the method which delegates to a traditional mock object. You can use this mock object to set up stubbed return values or set up expectations of methods to be called. After the test completes the stubbed version of the method is removed and replaced by the original.

I'm thinking of ditching the name Stubba, because this part of the library is not solely concerned with stubbing. Let me know what you think.

Martin Fowler has a must-read article on why "Mocks Aren't Stubs":http://www.martinfowler.com/articles/mocksArentStubs.html.

Another great reference is JMocks documentation - in particular "Yoga for your Unit Tests":http://www.jmock.org/yoga.html.

