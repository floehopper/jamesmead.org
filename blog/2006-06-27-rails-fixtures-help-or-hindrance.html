<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Rails fixtures - help or hindrance - James Mead</title>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="keywords" content="rails fixture test" />
    <meta name="author" content= "James Mead" />

    <meta name="verify-v1" content="H0rIfyqCDW+br6ieZtuZ+Hnt3ii3FpF22qFYjZmO+3E=" />
    <meta name="y_key" content="5f5b0de20991e0c2" />
    <meta name="msvalidate.01" content="5D5476B4F9F70AAFE14D519093E3FFA8" />

    <link href="/images/favicon.gif" rel="icon" type="image/gif" />

    <link href="/stylesheets/yui/3.18.1/cssreset-min.css" rel="stylesheet" /><link href="/stylesheets/yui/3.18.1/cssfonts-min.css" rel="stylesheet" /><link href="/stylesheets/yui/3.18.1/cssbase-min.css" rel="stylesheet" />

    <link href="/stylesheets/site.css" rel="stylesheet" />

    <link href="/stylesheets/prettify/prettify.css" rel="stylesheet" />
    <script src="/javascripts/prettify/prettify.js" defer="defer"></script>

    <link rel="alternate" type="application/atom+xml" title="Atom" href="http://feeds.jamesmead.org/floehopper-blog" />

    <link rel="webmention" href="https://webmention.io/jamesmead.org/webmention" />

    <link rel="prev" href="/blog/2006-02-22-gadget-reviews" />
    <link rel="next" href="/blog/2006-07-03-catch-22-adsl-house-move" />
    <link rel="first" href="/blog/2004-05-14-unit-tests-can-100-coverage-be-a-bad-thing" />
    <link rel="last" href="/blog/2022-05-18-how-to-backup-google-drive-to-s3-using-the-aws-cdk" />
    <link rel="index" href="/blog" />

  </head>
  <body class="blog blog_2006-06-27-rails-fixtures-help-or-hindrance" onload="prettyPrint()">
    <div id="doc">
      <div class="skip-links">
        <a href="#bd">Skip to main content</a>
      </div>

      <header id="hd">
        <nav aria-label="Primary">
          <a href="/">Home</a>
          &middot;
          <a href="/blog/">Blog</a>
          &middot;
          <a href="/adventures/">Adventures</a>
          &middot;
          <a href="/notes/">Notes</a>
          &middot;
          <a href="/talks/">Talks</a>
          &middot;
          <a href="/projects/">Projects</a>
        </nav>
      </header>

      <main id="bd">
          <article class="h-entry">
    <header>
      <h1 class="p-name">Rails fixtures - help or hindrance</h1>
    </header>

    <section class="e-content">
      <p>So it looks like <a href="http://www.reevoo.com/blogs/bengriffiths/">Ben</a> has finally <a href="http://metaatem.net/2006/06/24/railsconf-panel-thoughtworks-on-rails-with-obie-fernandez#comment-1645">shamed</a> me into writing my <em>annual</em> blog entry.</p>
<p>My colleague <a href="http://blog.seagul.co.uk/">Chris</a> recently pointed me at a <a href="http://www.oreillynet.com/ruby/blog/2006/06/railsconf_2006_day_3_last_day.html">report</a> from <a href="http://www.railsconf.org/">RailsConf 2006</a>. It didn&#8217;t surprise me to read that fixtures are the part of Rails with which the core team are most unhappy &#8212; apparently about half of them don&#8217;t even use fixtures.</p>
<p>In the early stages of developing a Rails application, the fixtures functionality built into Test::Unit::TestCase by ActiveRecord can be pretty useful. However, as the application grows it becomes harder and harder to stop fixtures getting in your way. One of the more obvious problems is your test suite taking longer and longer to run. This is often tackled by making performance improvements like using <a href="http://clarkware.com/cgi/blosxom/2005/10/24">transactional fixtures</a> or using an <a href="http://martinfowler.com/bliki/InMemoryTestDatabase.html">in-memory database</a>. But if your application is continuing to grow, it really only buys you time.</p>
<p>I think the <a href="http://noodlesinmysandals.com/blog/index.php/2006/05/23/mock-objects-speed-up-testing/">performance</a> <a href="http://www.reevoo.com/blogs/bengriffiths/2006/05/11/more-ruby-unit-testing/">problem</a> is merely the most visible symptom of a deeper malaise. Data in fixture files&#8230;</p>
<ul>
	<li>is effectively global &#8212; unless you are <em>very</em> strict about having a single role for each fixture record, it&#8217;s very easy to share fixtures across many unrelated tests because it is convenient and not because its sensible. This is essentially a coupling problem and leads to brittle tests where changing one attribute of one fixture record breaks a bunch of tests.</li>
	<li>reduces the self-contained readability of tests &#8212; personally I dislike even having to scroll to the top of the TestCase to find the setup method, let alone having to navigate to another file.</li>
	<li>leads to tedious and error-prone setup when you have complex object graphs and is just as hard to read/navigate afterwards.</li>
	<li>leaves data in the database after the last test in a TestCase &#8212; potentially interacting with a subsequent TestCase.</li>
	<li>encourages unit tests that interact with the database &#8212; although this is what slows tests down, you should also realise it means the unit that&#8217;s being tested includes not only your application class, but many lines of ActiveRecord code as well as the underlying database. Given that this 3rd party code is likely to be well-tested, it seems like overkill to include it in your own application&#8217;s unit tests.</li>
	<li>is artificial data &#8212; it gets directly inserted into the database bypassing all business logic and validation. So it&#8217;s very easy to end up testing impossible scenarios or even getting false positives.</li>
</ul>
<p>So what&#8217;s a better way to write unit tests? That&#8217;ll have to wait until next year ;-)</p>
    </section>

    <footer>
      <p class="metadata">
        Published by <a class="p-author h-card" href="https://jamesmead.org/">James Mead</a> on <a class="u-url" href="https://jamesmead.org/blog/2006-06-27-rails-fixtures-help-or-hindrance"><time class="dt-published" datetime="2006-06-27T20:13:00+00:00">27 Jun 2006 at 20:13</time></a>
      </p>
      <div class="webmentions" data-webmentions="https://jamesmead.org/blog/2006-06-27-rails-fixtures-help-or-hindrance">
  <template id="webmention-template">
    <li class="webmention">
      <div>
        <a class="author">
          <span class="author-name"></span>
        </a>
        <a class="action"></a>
      </div>
      <div class="content"></div>
    </li>
  </template>
</div>

<script src="/javascripts/webmentions.js" type="text/javascript" charset="utf-8" defer></script>

    </footer>
  </article>


          <nav id="navigation" aria-label="Inter-article">
      <a href="/blog/2006-02-22-gadget-reviews" class="previous">&lt; Gadget Reviews</a>
      <a href="/blog/2006-07-03-catch-22-adsl-house-move" class="next">Catch 22 - ADSL house move &gt;</a>
  </nav>

      </main>

      <footer id="ft">
        <nav aria-label="Footer">
          <a href="/contact">Contact</a>
          &middot;
          <a href="/history">History</a>
          &middot;
          <a href="/colophon">Colophon</a>
          &middot;
          <a href="/links">Links</a>
        </nav>
        <div id="indieweb-ring">
          <a href="https://xn--sr8hvo.ws/%F0%9F%93%BF%F0%9F%8C%91%F0%9F%A6%82/previous">‚Üê</a>
          An IndieWeb Webring üï∏üíç
          <a href="https://xn--sr8hvo.ws/%F0%9F%93%BF%F0%9F%8C%91%F0%9F%A6%82/next">‚Üí</a>
        </div>
        <p id="creative-commons" xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text">
          This work by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="jamesmead.org">James Mead</a> is licensed under
          <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons logo" />
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons Attribution icon" />
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons ShareAlike icon" />
          </a>
        </p>
      </footer>
    </div>
  </body>
</html>
