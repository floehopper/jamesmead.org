<!DOCTYPE html>
<html lang="en">
  <head>
    <title>The Difference between Mocks and Stubs - James Mead</title>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="keywords" content="ruby difference mock stub expectation mocha stubba testing mocking stubbing" />
    <meta name="author" content= "James Mead" />

    <meta name="verify-v1" content="H0rIfyqCDW+br6ieZtuZ+Hnt3ii3FpF22qFYjZmO+3E=" />
    <meta name="y_key" content="5f5b0de20991e0c2" />
    <meta name="msvalidate.01" content="5D5476B4F9F70AAFE14D519093E3FFA8" />

    <link href="/images/favicon.gif" rel="icon" type="image/gif" />

    <link href="/stylesheets/yui/3.18.1/cssreset-min.css" rel="stylesheet" /><link href="/stylesheets/yui/3.18.1/cssfonts-min.css" rel="stylesheet" /><link href="/stylesheets/yui/3.18.1/cssbase-min.css" rel="stylesheet" />

    <link href="/stylesheets/site.css" rel="stylesheet" />

    <link href="/stylesheets/prettify/prettify.css" rel="stylesheet" />
    <script src="/javascripts/prettify/prettify.js" defer="defer"></script>

    <link rel="alternate" type="application/atom+xml" title="Atom" href="http://feeds.jamesmead.org/floehopper-blog" />

    <link rel="webmention" href="https://webmention.io/jamesmead.org/webmention" />

    <link rel="prev" href="/blog/2006-09-06-my-reevoo-birthday" />
    <link rel="next" href="/blog/2006-09-13-google-test-automation-railsconf-europe" />
    <link rel="first" href="/blog/2004-05-14-unit-tests-can-100-coverage-be-a-bad-thing" />
    <link rel="last" href="/blog/2022-05-18-how-to-backup-google-drive-to-s3-using-the-aws-cdk" />
    <link rel="index" href="/blog" />

  </head>
  <body class="blog blog_2006-09-11-the-difference-between-mocks-and-stubs" onload="prettyPrint()">
    <div id="doc">
      <div class="skip-links">
        <a href="#bd">Skip to main content</a>
      </div>

      <header id="hd">
        <nav aria-label="Primary">
          <a href="/">Home</a>
          &middot;
          <a href="/blog/">Blog</a>
          &middot;
          <a href="/notes/">Notes</a>
          &middot;
          <a href="/talks/">Talks</a>
          &middot;
          <a href="/projects/">Projects</a>
        </nav>
      </header>

      <main id="bd">
          <article class="h-entry">
    <header>
      <h1 class="p-name">The Difference between Mocks and Stubs</h1>
    </header>

    <section class="e-content">
      <p>Some recent converstations have made me realise that a lot of people are confused by the difference between mocking and stubbing. I&#8217;ve realised that I&#8217;ve only added to the confusion by calling part of the <a href="http://mocha.rubyforge.com">Mocha</a> library, Stubba.</p>
<h2>The difference between mocking and stubbing</h2>
<p>Stubbing a method is all about replacing the method with code that returns a specified result (or perhaps raises a specified exception). Mocking a method is all about asserting that a method has been called (perhaps with particular parameters).</p>
<p>If you think about it, it&#8217;s difficult (or impossible?) to do mocking without stubbing &#8211; you need to return from the mocked method, so that the code under test can complete execution. So mocking libraries tend to implicitly or explicitly allow you to do stubbing.</p>
<h2>Mocking and stubbing with Mocha</h2>
<p>To stub a method, use the <a href="https://web.archive.org/web/20061012051726/http://mocha.rubyforge.org/classes/Mocha/MockMethods.html#M000006">stubs</a> method.<br />
To mock a method, use the <a href="https://web.archive.org/web/20061012051726/http://mocha.rubyforge.org/classes/Mocha/MockMethods.html#M000005">expects</a> method.</p>
<h2>The difference between Mocha and Stubba</h2>
<p><a href="http://mocha.rubyforge.com">Mocha</a> is a traditional mocking library very much in the <a href="http://www.jmock.org">JMock</a> mould. Stubba is a separate part of Mocha that allows mocking <strong>and</strong> stubbing of methods on real (non-mock) classes. It works by moving the method of interest to one side, adding a new stubbed version of the method which delegates to a traditional mock object. You can use this mock object to set up stubbed return values or set up expectations of methods to be called. After the test completes the stubbed version of the method is removed and replaced by the original.</p>
<p>I&#8217;m thinking of ditching the name Stubba, because this part of the library is not solely concerned with stubbing. Let me know what you think.</p>
<p>Martin Fowler has a must-read article on why <a href="http://www.martinfowler.com/articles/mocksArentStubs.html">Mocks Aren&#8217;t Stubs</a>.</p>
<p>Another great reference is JMocks documentation &#8211; in particular <a href="http://www.jmock.org/yoga.html">Yoga for your Unit Tests</a>.</p>
<pre class="prettyprint"><code class="prettyprint">class ClassUnderTest
  def initialize(dependency)
    @dependency = dependency
  end
  def do_it
    @dependency.execute
  end
end</code>

<code class="prettyprint">class Dependency
  def execute
    # complicated code
  end
end</code></pre>
<h2>Stubbing example</h2>
<pre class="prettyprint"><code class="prettyprint">class MyTest &lt; Test::Unit::TestCase
  class DependencyStub
    def execute
      true
    end
  end
  def test_stubbing_example
    dependency = DependencyStub.new
    class_under_test = ClassUnderTest.new(dependency)
    assert_equal true, class_under_test.do_it
  end
end</code></pre>
<h2>Mocking example</h2>
<pre class="prettyprint"><code class="prettyprint">class MyTest &lt; Test::Unit::TestCase
  class DependencyMock
    attr_reader :call_count
    def initialize
      @call_count = 0
    end
    def execute
      @call_count += 1
    end
  end
  def test_mocking_example
    dependency = DependencyMock.new
    class_under_test = ClassUnderTest.new(dependency)
    class_under_test.do_it
    assert_equal 1, dependency.call_count
  end
end
</code></pre>
    </section>

    <footer>
      <p class="metadata">
        Published by <a class="p-author h-card" href="https://jamesmead.org/">James Mead</a> on <a class="u-url" href="https://jamesmead.org/blog/2006-09-11-the-difference-between-mocks-and-stubs"><time class="dt-published" datetime="2006-09-11T03:57:15+00:00">11 Sep 2006 at 03:57</time></a>
      </p>
      <div class="webmentions" data-webmentions="https://jamesmead.org/blog/2006-09-11-the-difference-between-mocks-and-stubs">
  <template id="webmention-template">
    <li class="webmention">
      <div>
        <a class="author">
          <span class="author-name"></span>
        </a>
        <a class="action"></a>
      </div>
      <div class="content"></div>
    </li>
  </template>
</div>

<script src="/javascripts/webmentions.js" type="text/javascript" charset="utf-8" defer></script>

    </footer>
  </article>


          <nav id="navigation" aria-label="Inter-article">
      <a href="/blog/2006-09-06-my-reevoo-birthday" class="previous">&lt; My Reevoo Birthday</a>
      <a href="/blog/2006-09-13-google-test-automation-railsconf-europe" class="next">Google Test Automation & RailsConf Europe &gt;</a>
  </nav>

      </main>

      <footer id="ft">
        <nav style="float: left" aria-label="Footer">
          <a href="/contact">Contact</a>
          &middot;
          <a href="/history">History</a>
          &middot;
          <a href="/colophon">Colophon</a>
          &middot;
          <a href="/links">Links</a>
        </nav>
        <div style="float: right">
          <a href="https://xn--sr8hvo.ws/%F0%9F%93%BF%F0%9F%8C%91%F0%9F%A6%82/previous">‚Üê</a>
          An IndieWeb Webring üï∏üíç
          <a href="https://xn--sr8hvo.ws/%F0%9F%93%BF%F0%9F%8C%91%F0%9F%A6%82/next">‚Üí</a>
        </div>
        <p style="clear: both" xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text">
          This work by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="jamesmead.org">James Mead</a> is licensed under
          <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons logo" />
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons Attribution icon" />
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons ShareAlike icon" />
          </a>
        </p>
      </footer>
    </div>
  </body>
</html>
