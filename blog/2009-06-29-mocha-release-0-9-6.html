<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Mocha Release 0.9.6 - James Mead</title>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="keywords" content="mocha mock stub ruby testing tdd" />
    <meta name="author" content= "James Mead" />

    <meta name="verify-v1" content="H0rIfyqCDW+br6ieZtuZ+Hnt3ii3FpF22qFYjZmO+3E=" />
    <meta name="y_key" content="5f5b0de20991e0c2" />
    <meta name="msvalidate.01" content="5D5476B4F9F70AAFE14D519093E3FFA8" />
    <meta name="fediverse:creator" content="@floehopper@ruby.social" />

    <link href="/images/favicon.gif" rel="icon" type="image/gif" />

    <link href="/stylesheets/yui/3.18.1/cssreset-min.css" rel="stylesheet" /><link href="/stylesheets/yui/3.18.1/cssfonts-min.css" rel="stylesheet" /><link href="/stylesheets/yui/3.18.1/cssbase-min.css" rel="stylesheet" />

    <link href="/stylesheets/site.css" rel="stylesheet" />

    <link href="/stylesheets/prettify/prettify.css" rel="stylesheet" />
    <script src="/javascripts/prettify/prettify.js" defer="defer"></script>

    <link rel="alternate" type="application/atom+xml" title="Atom" href="https://feeds.jamesmead.org/floehopper-blog" />

    <link rel="webmention" href="https://webmention.io/jamesmead.org/webmention" />

    <link rel="prev" href="/blog/2009-03-16-national-express-east-coast-ticket-options" />
    <link rel="next" href="/blog/2009-07-01-mocha-release-0-9-7" />
    <link rel="first" href="/blog/2004-05-14-unit-tests-can-100-coverage-be-a-bad-thing" />
    <link rel="last" href="/blog/2025-03-30-configuring-zed-editor-to-use-erb-lint-as-formatter" />
    <link rel="index" href="/blog" />

  </head>
  <body class="blog blog_2009-06-29-mocha-release-0-9-6" onload="prettyPrint()">
    <div id="doc">
      <div class="skip-links">
        <a href="#bd">Skip to main content</a>
      </div>

      <header id="hd">
        <nav aria-label="Primary">
          <a href="/">Home</a>
          &middot;
          <a href="/blog/">Blog</a>
          &middot;
          <a href="/adventures/">Adventures</a>
          &middot;
          <a href="/notes/">Notes</a>
          &middot;
          <a href="/talks/">Talks</a>
          &middot;
          <a href="/projects/">Projects</a>
        </nav>
      </header>

      <main id="bd">
          <article class="h-entry">
    <header>
      <h1 class="p-name">Mocha Release 0.9.6</h1>
    </header>

    <section class="e-content">
      <h2>Release Notes</h2>
<ul>
	<li>Version 2.0.1 of the <a href="http://test-unit.rubyforge.org/">test-unit gem</a> introduced a private <code>run_test</code> method on <code>TestCase</code> which clashed with the public <code>TestRunner#run_test</code> method. So this latter method has been renamed to <code>run_as_test</code>.</li>
	<li>Stop requiring <code>rubygems</code> &#8211; this should be an environmental choice for the user. <a href="http://gist.github.com/54177">This</a> describes why requiring <code>rubygems</code> in your library code is a bad idea.</li>
	<li>It seems like overkill to vendorize <code>coderay</code> and <code>meta_project</code> when they&#8217;re only needed to generate the examples for documentation and for publishing files on <a href="http://rubyforge.org/">RubyForge</a>. So I&#8217;m removing them and installing them locally as gems when I need them.</li>
	<li>Added support for <a href="http://test-unit.rubyforge.org/">test-unit gem</a> (version &gt;= 2.0). Note that as with other versions of <a href="http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/index.html">Test::Unit</a> I&#8217;m completely replacing the <code>TestCase#run</code> method. Unfortunately in version 2.0.0 this method differs slightly from the same method in version 2.0.1 &amp; 2.0.2, so we have to provide different implementations to ensure that the internal working of <a href="http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/index.html">Test::Unit</a> are not compromised by <a href="https://mocha.jamesmead.org/">Mocha</a>. Note also that unless the <a href="http://test-unit.rubyforge.org/">test-unit gem</a> is loaded, requiring <code>'test/unit'</code> leads to a mixture of standard library and gem classes being loaded causing errors. To avoid a dependency on <code>rubygems</code>, the gem is loaded only if <code>MOCHA_OPTIONS</code> is set to <code>use_test_unit_gem</code> &#8211; this option is only intended for use in running <a href="https://mocha.jamesmead.org/">Mocha&#8217;s</a> own tests. It might be worthwhile to create a shim gem like <code>minitest_tu_shim</code> to allow the <a href="http://test-unit.rubyforge.org/">test-unit gem</a> to completely replace the standard library, but that&#8217;s a job for another day. <a href="/blog/2009-02-02-test-unit-and-minitest-with-different-ruby-versions#minitest-tu-shim">My previous article on Test::Unit and MiniTest</a> explains how the <code>minitest-tu-shim</code> works. The changes in the <code>Rakefile</code> are to make the default task run with the <a href="http://test-unit.rubyforge.org/">test-unit gem</a> (version &gt;= 2.0).</li>
	<li>Renamed <code>Mocha::Standalone</code> to <a href="https://web.archive.org/web/20090712163035/http://mocha.rubyforge.org/classes/Mocha/API.html">Mocha::API</a> to better reflect its purpose. Added a deprecation warning for those who are referencing <code>Mocha::Standalone</code>.</li>
	<li>Fix exception raised by <a href="https://web.archive.org/web/20100206044037/http://mocha.rubyforge.org/classes/Mocha/ParameterMatchers.html#M000015">HasEntry#matches?</a> when first parameter is not a <code>Hash</code> (thanks to <a href="http://taylorbarstow.com/">Taylor Barstow</a>).</li>
	<li><a href="http://www.metaskills.net/">Ken Collins</a> <a href="http://rails.lighthouseapp.com/projects/8994-ruby-on-rails/tickets/2060">reported</a> that <a href="https://mocha.jamesmead.org/">Mocha</a> is always loading <a href="http://blog.zenspider.com/minitest/">MiniTest</a> if it is available and loading it causes some <code>Rails</code>/<code>ActionPack</code> tests to break. I&#8217;ve removed the loading of <a href="http://blog.zenspider.com/minitest/">MiniTest</a>, but this now means the user has to ensure that if they want to use <a href="http://blog.zenspider.com/minitest/">MiniTest</a> in conjunction with <a href="https://mocha.jamesmead.org/">Mocha</a>, he must load <a href="http://blog.zenspider.com/minitest/">MiniTest</a> before loading <a href="https://mocha.jamesmead.org/">Mocha</a>.</li>
	<li>Implemented <a href="http://github.com/chneukirchen/bacon/">Bacon</a> integration (thanks to <a href="http://github.com/Bira">Ubiratan Pires Alberton</a>), but this was then removed after deciding only to maintain integration with <a href="http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/index.html">Test::Unit</a> and <a href="http://blog.zenspider.com/minitest/">MiniTest</a> which are both Ruby standard libraries. See <a href="http://groups.google.com/group/mocha-developer/t/f01e55656e365567">mailing list message</a> for details.</li>
	<li>Don&#8217;t monkey-patch <a href="http://blog.zenspider.com/minitest/">MiniTest</a> if it&#8217;s already been monkey-patched by <a href="https://mocha.jamesmead.org/">Mocha</a>.</li>
	<li>Fixed <a href="http://floehopper.lighthouseapp.com/projects/22289-mocha/tickets/41">bug</a> &#8211; <a href="http://blog.zenspider.com/minitest/">MiniTest</a> integration was counting <code>ExpectationErrors</code> as errors not failures.</li>
	<li>Fixed <a href="http://floehopper.lighthouseapp.com/projects/22289-mocha/tickets/43">bug</a> &#8211; Some <a href="http://github.com/chneukirchen/bacon/">Bacon</a> tests were failing in <a href="http://www.ruby-lang.org/en/news/2009/01/30/ruby-1-9-1-released/">Ruby 1.9.1</a>.</li>
	<li><a href="http://spicycode.com/">Chad Humphries</a> pointed out that in <a href="http://www.ruby-lang.org/en/news/2009/01/30/ruby-1-9-1-released/">Ruby 1.9.1</a>, if you are not using <a href="http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/index.html">Test::Unit</a> or <a href="http://blog.zenspider.com/minitest/">MiniTest</a>, <a href="https://mocha.jamesmead.org/">Mocha</a> will attempt to load and monkey-patch <a href="http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/index.html">Test::Unit</a>. <a href="https://mocha.jamesmead.org/">Mocha</a> will now only monkey-patch <a href="http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/index.html">Test::Unit</a> and/or <a href="http://blog.zenspider.com/minitest/">MiniTest</a> if they have already been loaded. <a href="http://blog.zenspider.com/minitest/">MiniTest</a> tests will now run in both Ruby 1.8.6 (with <a href="http://blog.zenspider.com/minitest/">MiniTest</a> gem) and in <a href="http://www.ruby-lang.org/en/news/2009/01/30/ruby-1-9-1-released/">Ruby 1.9.1</a> (with <a href="http://blog.zenspider.com/minitest/">MiniTest</a> standard library). See <a href="http://floehopper.lighthouseapp.com/projects/22289/tickets/49">Lighthouse ticket</a>.</li>
	<li>Made <a href="https://mocha.jamesmead.org/">Mocha</a> compatible with minitest 1.4.0 and above (thanks to <a href="http://stoneship.org/">Denis Defreyne</a>).</li>
</ul>
    </section>

    <footer>
      <p class="metadata">
        Published by <a class="p-author h-card" href="https://jamesmead.org/">James Mead</a> on <a class="u-url" href="https://jamesmead.org/blog/2009-06-29-mocha-release-0-9-6"><time class="dt-published" datetime="2009-06-29T16:29:54+00:00">29 Jun 2009 at 16:29</time></a>
      </p>
      <div class="webmentions" data-webmentions="https://jamesmead.org/blog/2009-06-29-mocha-release-0-9-6">
  <template id="webmention-template">
    <li class="webmention">
      <div>
        <a class="author">
          <span class="author-name"></span>
        </a>
        <a class="action"></a>
      </div>
      <div class="content"></div>
    </li>
  </template>
</div>

<script src="/javascripts/webmentions.js" type="text/javascript" charset="utf-8" defer></script>

    </footer>
  </article>


          <nav id="navigation" aria-label="Inter-article">
      <a href="/blog/2009-03-16-national-express-east-coast-ticket-options" class="previous">&lt; National Express East Coast Ticket Options</a>
      <a href="/blog/2009-07-01-mocha-release-0-9-7" class="next">Mocha Release 0.9.7 &gt;</a>
  </nav>

      </main>

      <footer id="ft">
        <nav aria-label="Footer">
          <a href="/contact">Contact</a>
          &middot;
          <a href="/history">History</a>
          &middot;
          <a href="/colophon">Colophon</a>
          &middot;
          <a href="/links">Links</a>
        </nav>
        <div id="indieweb-ring">
          <a href="https://xn--sr8hvo.ws/%F0%9F%93%BF%F0%9F%8C%91%F0%9F%A6%82/previous">←</a>
          An IndieWeb Webring 🕸💍
          <a href="https://xn--sr8hvo.ws/%F0%9F%93%BF%F0%9F%8C%91%F0%9F%A6%82/next">→</a>
        </div>
        <div id="creative-commons" xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text">
          This work by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://jamesmead.org">James Mead</a> is licensed under
          <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons logo" />
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons Attribution icon" />
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons ShareAlike icon" />
          </a>
        </div>
        <div id="five-hundred-and-twelve-kb">
          <a href="https://512kb.club">
            <img src="https://512kb.club/assets/images/green-team.svg" alt="a proud member of the green team of 512KB club" />
          </a>
        </div>
      </footer>
    </div>
  </body>
</html>
