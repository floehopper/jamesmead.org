<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Permutations, Combinations & Probability - James Mead</title>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="keywords" content="ruby permutation combination probability" />
    <meta name="author" content= "James Mead" />

    <meta name="verify-v1" content="H0rIfyqCDW+br6ieZtuZ+Hnt3ii3FpF22qFYjZmO+3E=" />
    <meta name="y_key" content="5f5b0de20991e0c2" />
    <meta name="msvalidate.01" content="5D5476B4F9F70AAFE14D519093E3FFA8" />

    <link href="/images/favicon.gif" rel="icon" type="image/gif" />

    <link href="/stylesheets/yui/3.18.1/cssreset-min.css" rel="stylesheet" /><link href="/stylesheets/yui/3.18.1/cssfonts-min.css" rel="stylesheet" /><link href="/stylesheets/yui/3.18.1/cssbase-min.css" rel="stylesheet" />

    <link href="/stylesheets/site.css" rel="stylesheet" />

    <link href="/stylesheets/prettify/prettify.css" rel="stylesheet" />
    <script src="/javascripts/prettify/prettify.js" defer="defer"></script>

    <link rel="alternate" type="application/atom+xml" title="Atom" href="http://feeds.jamesmead.org/floehopper-blog" />

    <link rel="webmention" href="https://webmention.io/jamesmead.org/webmention" />

    <link rel="prev" href="/blog/2008-11-03-mocha-release-0-9-2" />
    <link rel="next" href="/blog/2008-11-27-mocha-release-0-9-3" />
    <link rel="first" href="/blog/2004-05-14-unit-tests-can-100-coverage-be-a-bad-thing" />
    <link rel="last" href="/blog/2022-11-01-mocha-v2-release" />
    <link rel="index" href="/blog" />

  </head>
  <body class="blog blog_2008-11-04-permutations-combinations-probability" onload="prettyPrint()">
    <div id="doc">
      <div class="skip-links">
        <a href="#bd">Skip to main content</a>
      </div>

      <header id="hd">
        <nav aria-label="Primary">
          <a href="/">Home</a>
          &middot;
          <a href="/blog/">Blog</a>
          &middot;
          <a href="/adventures/">Adventures</a>
          &middot;
          <a href="/notes/">Notes</a>
          &middot;
          <a href="/talks/">Talks</a>
          &middot;
          <a href="/projects/">Projects</a>
        </nav>
      </header>

      <main id="bd">
          <article class="h-entry">
    <header>
      <h1 class="p-name">Permutations, Combinations & Probability</h1>
    </header>

    <section class="e-content">
      <p>This weekend I spent an enjoyable couple of hours trying to solve a very simple sounding problem&#8230;</p>
<blockquote>
<p>Given a set of four digits chosen at random (0-9 equally likely in each case), and a second set of four digits similarly chosen at random, on average how many digits will match (order is not important).</p>
</blockquote>
<p><em>Update: Although I said that 0-9 is equally likely in each case, I didn&#8217;t make it clear that repetitions are allowed i.e. 1234 vs 5432 =&gt; 3 matches</em></p>
<p><em>Update 2: I just <a href="http://pastie.org/307664">ran another brute force approach</a> using randomly generated sequences and got a very similar answer (approx 1.21) which gives me a bit more faith in my other attempt</em></p>
<p>I spent quite a while trying to dredge my memory (and the web) about <a href="http://en.wikipedia.org/wiki/Combinatorics">permutations &amp; combinations</a>, but never really got to grips with the problem. In the end, I hacked together a very nasty (probably inefficient &amp; un-idiomatic) chunk of Ruby to generate all the possible permutations of eight digits and count how many duplicates there were between the first four digits and the last four digits. From these I think you can work out the probability of one match, the probability of two matches, etc. Then I think you can calculate the average number of matches by weighting each probability by the number of matches. I may well be wrong!</p>
<p>In any case, I then generalized the Ruby to generate the results for different numbers of digits and different numeric bases (e.g. base 4 =&gt; 0, 1, 2, 3). I was hoping to see patterns in the results, so I could possibly reverse engineer a formula for the answer, but I haven&#8217;t managed to spend much time on that bit. But I&#8217;m sufficiently interested to embarrass myself by posting this on the internet and hoping that someone will tell me how to do this in one line of Maths or, more likely, one line of Ruby.</p>
<pre class="prettyprint"><code class="prettyprint">max_places = 4
puts (['base', 'places', ''] + (0..max_places).to_a).join("\t")</code>

<code class="prettyprint">(2..10).each do |base|
  (1..max_places).each do |places|
    counts = [0] * (places + 1)</code>

<code class="prettyprint">    (0...(base ** (places * 2))).each do |index|
     permutation = "%0#{places * 2}d" % index.to_s(base)
     original = (0...places).map { |i| permutation[i].chr }
     guess = (places...(places * 2)).map { |i| permutation[i].chr }
     matches = 0
     guess.each do |g|
       (0...places).each do |i|
         if g == original[i]
           original[i] = nil
           matches += 1
           break
         end
       end
     end
     counts[matches] += 1
    end</code>

<code class="prettyprint">    puts (["%2d" % base, places, ''] + counts).join("\t")
    $stdout.flush
  end
end</code></pre>
<p>I think the answer for four digits between 0-9 comes out as follows:-</p>
<ul>
	<li>Exactly zero matches = 19550250</li>
	<li>Exactly one match = 45608400</li>
	<li>Exactly two matches = 29292120</li>
	<li>Exactly three matches = 5373360</li>
	<li>Exactly four matches = 175870</li>
</ul>
<p>Which gives an average number of matches = 1.21</p>
<p>However, looking at it now, I&#8217;m wondering how there could be so many permutations with exactly four matches. Oh, well. I might as well publish anyway and find out what I&#8217;ve done wrong&#8230;</p>
<ul>
	<li><a href="http://spreadsheets.google.com/ccc?key=p_yLkue0gmhqV4ElV6pWHMQ">Google Docs spreadsheet</a></li>
	<li><a href="http://spreadsheets.google.com/pub?key=p_yLkue0gmhqV4ElV6pWHMQ">Google Docs web page</a></li>
</ul>
<p>In amongst it all I found a couple of nice Ruby methods I hadn&#8217;t come across before:-</p>
<ul>
	<li><a href="http://ruby-doc.org/core/classes/Fixnum.html#M001069" title="base">Fixnum#to_s</a></li>
	<li><a href="http://ruby-doc.org/core/classes/String.html#M000849">String#count</a>, which I didn&#8217;t use in the end.</li>
</ul>
    </section>

    <footer>
      <p class="metadata">
        Published by <a class="p-author h-card" href="https://jamesmead.org/">James Mead</a> on <a class="u-url" href="https://jamesmead.org/blog/2008-11-04-permutations-combinations-probability"><time class="dt-published" datetime="2008-11-04T00:27:06+00:00">04 Nov 2008 at 00:27</time></a>
      </p>
      <div class="webmentions" data-webmentions="https://jamesmead.org/blog/2008-11-04-permutations-combinations-probability">
  <template id="webmention-template">
    <li class="webmention">
      <div>
        <a class="author">
          <span class="author-name"></span>
        </a>
        <a class="action"></a>
      </div>
      <div class="content"></div>
    </li>
  </template>
</div>

<script src="/javascripts/webmentions.js" type="text/javascript" charset="utf-8" defer></script>

    </footer>
  </article>


          <nav id="navigation" aria-label="Inter-article">
      <a href="/blog/2008-11-03-mocha-release-0-9-2" class="previous">&lt; Mocha Release 0.9.2</a>
      <a href="/blog/2008-11-27-mocha-release-0-9-3" class="next">Mocha Release 0.9.3 &gt;</a>
  </nav>

      </main>

      <footer id="ft">
        <nav aria-label="Footer">
          <a href="/contact">Contact</a>
          &middot;
          <a href="/history">History</a>
          &middot;
          <a href="/colophon">Colophon</a>
          &middot;
          <a href="/links">Links</a>
        </nav>
        <div id="indieweb-ring">
          <a href="https://xn--sr8hvo.ws/%F0%9F%93%BF%F0%9F%8C%91%F0%9F%A6%82/previous">‚Üê</a>
          An IndieWeb Webring üï∏üíç
          <a href="https://xn--sr8hvo.ws/%F0%9F%93%BF%F0%9F%8C%91%F0%9F%A6%82/next">‚Üí</a>
        </div>
        <div id="creative-commons" xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text">
          This work by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="jamesmead.org">James Mead</a> is licensed under
          <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons logo" />
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons Attribution icon" />
            <img style="height:16px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" loading="lazy" alt="Creative Commons ShareAlike icon" />
          </a>
        </div>
        <div id="five-hundred-and-twelve-kb">
          <a href="https://512kb.club">
            <img src="https://512kb.club/assets/images/green-team.svg" alt="a proud member of the green team of 512KB club" />
          </a>
        </div>
      </footer>
    </div>
  </body>
</html>
