function hasClass(e,n){return!!e.className&&-1!=e.className.search("(^|\\s)"+n+"(\\s|$)")}function hasValue(e,n){return!!e&&-1!=e.search("(^|\\s)"+n+"(\\s|$)")}function removeClass(e,n){e&&(e.className=e.className.replace(new RegExp("(^|\\s)"+n+"(\\s|$)"),RegExp.$1+RegExp.$2))}function addClass(e,n){e&&!hasClass(e,n)&&(e.className?e.className+=" "+n:e.className=n)}function GetElementsWithClassName(e,n){for(var t=document.getElementsByTagName(e),s=new Array,i=0;i<t.length;i++)hasClass(t[i],n)&&(s[s.length]=t[i]);return s}function isParentOrSelf(e,n){return null!=e&&"BODY"!=e.nodeName&&(e.id==n||isParentOrSelf(e.parentNode,n))}function nodeValue(e){var n="";if(1==e.nodeType)for(var t=e.childNodes,s=0;s<t.length;++s)n+=nodeValue(t[s]);else 3==e.nodeType&&(n=e.nodeValue);return n}function slideLabel(){var e=GetElementsWithClassName("*","slide"),n=document.getElementById("jumplist");smax=e.length;for(var t=0;t<smax;t++){var s=e[t],i="slide"+t.toString();if(s.setAttribute("id",i),!isOp){var l="",a=s.firstChild;if(a){for(;a&&3==a.nodeType;)a=a.nextSibling;if(a){for(var r=a.childNodes,o=0;o<r.length;o++)l+=nodeValue(r[o]);n.options[n.length]=new Option(t+" : "+l,t)}}}}}function currentSlide(){var e;e=document.getElementById?document.getElementById("currentSlide"):document.currentSlide,e.innerHTML='<span id="csHere">'+snum+'</span> <span id="csSep">/</span> <span id="csTotal">'+(smax-1)+"</span>",e.style.visibility=0==snum?"hidden":"visible"}function go(e){if(!document.getElementById("slideProj").disabled&&0!=e){var n=document.getElementById("jumplist"),t="slide"+snum,s=document.getElementById(t);if(incrementals[snum].length>0)for(var i=0;i<incrementals[snum].length;i++)removeClass(incrementals[snum][i],"current"),removeClass(incrementals[snum][i],"incremental");"j"!=e?(snum+=e,lmax=smax-1,snum>lmax&&(snum=lmax),snum<0&&(snum=0)):snum=parseInt(n.value);var l="slide"+snum,a=document.getElementById(l);if(a||(a=document.getElementById("slide0"),snum=0),incpos=e<0?incrementals[snum].length:0,incrementals[snum].length>0&&0==incpos)for(var i=0;i<incrementals[snum].length;i++)hasClass(incrementals[snum][i],"current")?incpos=i+1:addClass(incrementals[snum][i],"incremental");incrementals[snum].length>0&&incpos>0&&addClass(incrementals[snum][incpos-1],"current"),s.style.visibility="hidden",a.style.visibility="visible",n.selectedIndex=snum,currentSlide(),number=0}}function goTo(e){e>=smax||e==snum||go(e-snum)}function subgo(e){e>0?(removeClass(incrementals[snum][incpos-1],"current"),removeClass(incrementals[snum][incpos],"incremental"),addClass(incrementals[snum][incpos],"current"),incpos++):(incpos--,removeClass(incrementals[snum][incpos],"current"),addClass(incrementals[snum][incpos],"incremental"),addClass(incrementals[snum][incpos-1],"current"))}function toggle(){var e=GetElementsWithClassName("*","slide"),n=document.getElementById("slideProj"),t=document.getElementById("outlineStyle");if(n.disabled){n.disabled=!1,t.disabled=!0,s5mode=!0,fontScale();for(var s=0;s<smax;s++){var i=e[s];i.style.visibility="hidden"}e[snum].style.visibility="visible"}else{n.disabled=!0,t.disabled=!1,s5mode=!1,fontSize("1em");for(var s=0;s<smax;s++){var i=e[s];i.style.visibility="visible"}}}function showHide(e){var n=GetElementsWithClassName("*","hideme")[0];switch(e){case"s":n.style.visibility="visible";break;case"h":n.style.visibility="hidden";break;case"k":"visible"!=n.style.visibility?n.style.visibility="visible":n.style.visibility="hidden"}}function keys(e){if(e||(e=event,e.which=e.keyCode),84==e.which)return void toggle();if(s5mode){switch(e.which){case 10:case 13:if(window.event&&isParentOrSelf(window.event.srcElement,"controls"))return;if(e.target&&isParentOrSelf(e.target,"controls"))return;if(number!=undef){goTo(number);break}case 32:case 34:case 39:case 40:number!=undef?go(number):!incrementals[snum]||incpos>=incrementals[snum].length?go(1):subgo(1);break;case 33:case 37:case 38:number!=undef?go(-1*number):!incrementals[snum]||incpos<=0?go(-1):subgo(-1);break;case 36:goTo(0);break;case 35:goTo(smax-1);break;case 67:showHide("k")}if(e.which<48||e.which>57)number=undef;else{if(window.event&&isParentOrSelf(window.event.srcElement,"controls"))return;if(e.target&&isParentOrSelf(e.target,"controls"))return;number=10*(number!=undef?number:0)+(e.which-48)}}return!1}function clicker(e){number=undef;var n;if(window.event?(n=window.event.srcElement,e=window.event):n=e.target,null!=n.getAttribute("href")||hasValue(n.rel,"external")||isParentOrSelf(n,"controls")||isParentOrSelf(n,"embed")||isParentOrSelf(n,"object"))return!0;e.which&&1!=e.which||(!incrementals[snum]||incpos>=incrementals[snum].length?go(1):subgo(1))}function findSlide(e){for(var n=null,t=GetElementsWithClassName("*","slide"),s=0;s<t.length;s++){var i=t[s];if(i.name&&i.name==e||i.id&&i.id==e){n=i;break}}for(;null!=n&&"BODY"!=n.nodeName;){if(hasClass(n,"slide"))return parseInt(n.id.slice(5));n=n.parentNode}return null}function slideJump(){if(null!=window.location.hash){var e=/^#slide(\d+)$/,n=e.exec(window.location.hash),t=null;t=null!=n?parseInt(n[1]):findSlide(window.location.hash.slice(1)),null!=t&&go(t-snum)}}function fixLinks(){var e=window.location.href;e=e.slice(0,e.length-window.location.hash.length);for(var n=document.getElementsByTagName("A"),t=0;t<n.length;t++){var s=n[t].href,i=s.match("#slide[0-9]{1,2}");if(i&&"#"==i[0].slice(0,1)){var l=findSlide(i[0].slice(1));null!=l&&(n[t].addEventListener?n[t].addEventListener("click",new Function("e","if (document.getElementById('slideProj').disabled) return;go("+l+" - snum); if (e.preventDefault) e.preventDefault();"),!0):n[t].attachEvent&&n[t].attachEvent("onclick",new Function("","if (document.getElementById('slideProj').disabled) return;go("+l+" - snum); event.returnValue = false;")))}}}function externalLinks(){if(document.getElementsByTagName)for(var e=document.getElementsByTagName("a"),n=0;n<e.length;n++){var t=e[n];t.getAttribute("href")&&hasValue(t.rel,"external")&&(t.target="_blank",addClass(t,"external"))}}function createControls(){var e=document.getElementById("controls");if(e){var n,t=" onmouseover=\"showHide('s');\" onmouseout=\"showHide('h');\"",s="";if("hidden"==controlVis?n=t:s=t,e.innerHTML='<form action="#" id="controlForm"'+n+'><div id="navLinks"><a accesskey="t" id="toggle" href="javascript:toggle();">&#216;</a><a accesskey="z" id="prev" href="javascript:go(-1);">&laquo;</a><a accesskey="x" id="next" href="javascript:go(1);">&raquo;</a><div id="navList"'+s+'><select id="jumplist" onchange="go(\'j\');"></select></div></div></form>',"hidden"==controlVis)var i=document.getElementById("navLinks");else var i=document.getElementById("jumplist");addClass(i,"hideme")}}function fontScale(){if(!s5mode)return!1;var e=22,n=32;if(window.innerHeight)var t=window.innerHeight,s=window.innerWidth;else if(document.documentElement.clientHeight)var t=document.documentElement.clientHeight,s=document.documentElement.clientWidth;else if(document.body.clientHeight)var t=document.body.clientHeight,s=document.body.clientWidth;else var t=700,s=1024;if(fontSize(Math.min(Math.round(t/e),Math.round(s/n))+"px"),isGe){var i=document.getElementsByTagName("body")[0];i.style.display="none",i.style.display="block"}}function fontSize(e){if((s5ss=document.getElementById("s5ss"))||(isIE?(document.createStyleSheet(),document.s5ss=document.styleSheets[document.styleSheets.length-1]):(document.getElementsByTagName("head")[0].appendChild(s5ss=document.createElement("style")),s5ss.setAttribute("media","screen, projection"),s5ss.setAttribute("id","s5ss"))),isIE)document.s5ss.addRule("body","font-size: "+e+" !important;");else{for(;s5ss.lastChild;)s5ss.removeChild(s5ss.lastChild);s5ss.appendChild(document.createTextNode("body {font-size: "+e+" !important;}"))}}function notOperaFix(){slideCSS=document.getElementById("slideProj").href;var e=document.getElementById("slideProj"),n=document.getElementById("outlineStyle");e.setAttribute("media","screen"),n.disabled=!0,isGe&&(e.setAttribute("href","null"),e.setAttribute("href",slideCSS)),isIE&&document.styleSheets&&document.styleSheets[0]&&(document.styleSheets[0].addRule("img","behavior: url(ui/default/iepngfix.htc)"),document.styleSheets[0].addRule("div","behavior: url(ui/default/iepngfix.htc)"),document.styleSheets[0].addRule(".slide","behavior: url(ui/default/iepngfix.htc)"))}function getIncrementals(e){var n=new Array;if(!e)return n;for(var t=e.childNodes,s=0;s<t.length;s++){var i=t[s];if(hasClass(i,"incremental"))if("OL"==i.nodeName||"UL"==i.nodeName){removeClass(i,"incremental");for(var l=0;l<i.childNodes.length;l++)1==i.childNodes[l].nodeType&&addClass(i.childNodes[l],"incremental")}else n[n.length]=i,removeClass(i,"incremental");hasClass(i,"show-first")&&("OL"==i.nodeName||"UL"==i.nodeName?(removeClass(i,"show-first"),1==i.childNodes[isGe].nodeType&&removeClass(i.childNodes[isGe],"incremental")):n[n.length]=i),n=n.concat(getIncrementals(i))}return n}function createIncrementals(){for(var e=new Array,n=0;n<smax;n++)e[n]=getIncrementals(document.getElementById("slide"+n));return e}function defaultCheck(){for(var e=document.getElementsByTagName("meta"),n=0;n<e.length;n++)"defaultView"==e[n].name&&(defaultView=e[n].content),"controlVis"==e[n].name&&(controlVis=e[n].content)}function trap(e){e||(e=event,e.which=e.keyCode);try{modifierKey=e.ctrlKey||e.altKey||e.metaKey}catch(e){modifierKey=!1}return modifierKey||0==e.which}function startup(){defaultCheck(),isOp||createControls(),slideLabel(),fixLinks(),externalLinks(),fontScale(),isOp||(notOperaFix(),incrementals=createIncrementals(),slideJump(),"outline"==defaultView&&toggle(),document.onkeyup=keys,document.onkeypress=trap,document.onclick=clicker)}var undef,slideCSS="",snum=0,smax=1,incpos=0,number=undef,s5mode=!0,defaultView="slideshow",controlVis="visible",isIE="Microsoft Internet Explorer"==navigator.appName&&navigator.userAgent.indexOf("Opera")<1?1:0,isOp=navigator.userAgent.indexOf("Opera")>-1?1:0,isGe=navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("Safari")<1?1:0;window.onload=startup,window.onresize=function(){setTimeout("fontScale()",50)};