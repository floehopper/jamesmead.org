<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Ruby &amp; Cocoa - James Mead</title>
   <meta name="author" content="James Mead" />
   <meta name="company" content="Floehopper Ltd" />

   <!-- configuration parameters -->
   <meta name="defaultView" content="slideshow" />
   <meta name="controlVis" content="hidden" />

   <link rel="stylesheet" href="css/s5/slides.css" type="text/css" media="projection" id="slideProj" />
   <link rel="stylesheet" href="css/s5/outline.css" type="text/css" media="screen" id="outlineStyle" />
   <link rel="stylesheet" href="css/uv/twilight.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="css/main.css" type="text/css" media="screen, projection" />

   <!-- S5 JS -->
   <script src="javascript/s5/slides.js" type="text/javascript"></script>
</head>
<body>

<div class="layout">
  <div id="controls"><!-- DO NOT EDIT --></div>
  <div id="currentSlide"><!-- DO NOT EDIT --></div>
  <div id="header"></div>
  <div id="footer">
    <h1>Ruby Manor, 14th December 2009</h1>
    <h2>Ruby &amp; Cocoa</h2>
  </div>
</div>

<div class="presentation">
  <div class="slide">
<h1>Ruby &amp; Cocoa</h1>
<p><img src="images/ruby.png" class="logo ruby" alt="" /></p>
<p><img src="images/rclogo-cropped.png" class="logo cocoa" alt="" /></p>
</div>

<div class="slide">
<h1>Who?</h1>
</div>

<div class="slide">
<h1>Who?</h1>
<p><img src="images/antarctica011.jpg" class="portrait" alt="" /></p>
<ul>
	<li><span style="color:red;">James Mead</span></li>
</ul>
</div>

<div class="slide">
<h1>Who?</h1>
<p><img src="images/antarctica011.jpg" class="portrait" alt="" /></p>
<ul>
	<li>James Mead</li>
	<li><span style="color:red;">Ruby since 2005</span></li>
</ul>
</div>

<div class="slide">
<h1>Who?</h1>
<p><img src="images/antarctica011.jpg" class="portrait" alt="" /></p>
<ul>
	<li>James Mead</li>
	<li>Ruby since 2005</li>
	<li><span style="color:red;">Freelance Developer</span></li>
</ul>
</div>

<div class="slide">
<h1>Who?</h1>
<p><img src="images/antarctica011.jpg" class="portrait" alt="" /></p>
<ul>
	<li>James Mead</li>
	<li>Ruby since 2005</li>
	<li>Freelance Developer</li>
	<li><span style="color:red;">Floehopper Ltd</span></li>
</ul>
</div>

<div class="slide">
<h1>Who?</h1>
<p><img src="images/antarctica011.jpg" class="portrait" alt="" /></p>
<ul>
	<li>James Mead</li>
	<li>Ruby since 2005</li>
	<li>Freelance Developer</li>
	<li>Floehopper Ltd</li>
	<li><span style="color:red;">Author of Mocha</span></li>
</ul>
</div>

<div class="slide">
<h1>Who?</h1>
<p><img src="images/antarctica011.jpg" class="portrait" alt="" /></p>
<ul>
	<li>James Mead</li>
	<li>Ruby since 2005</li>
	<li>Freelance Developer</li>
	<li>Floehopper Ltd</li>
	<li>Author of Mocha</li>
	<li><span style="color:red;">Free Range</span></li>
</ul>
</div>

<div class="slide">
<h1>Who?</h1>
<p><img src="images/antarctica011.jpg" class="portrait" alt="" /></p>
<ul>
	<li>James Mead</li>
	<li>Ruby since 2005</li>
	<li>Freelance Developer</li>
	<li>Floehopper Ltd</li>
	<li>Author of Mocha</li>
	<li>Free Range</li>
	<li><span style="color:red;">Durham</span></li>
</ul>
</div>

<div class="slide">
<h1>Who?</h1>
<p><img src="images/antarctica011.jpg" class="portrait" alt="" /></p>
<ul>
	<li>James Mead</li>
	<li>Ruby since 2005</li>
	<li>Freelance Developer</li>
	<li>Floehopper Ltd</li>
	<li>Author of Mocha</li>
	<li>Free Range</li>
	<li>Durham</li>
	<li><span style="color:red;">@floehopper</span></li>
</ul>
</div>

<div class="slide">
<h1>Floehopping&#8230;</h1>
<p><img src="images/antarctica005.jpg" class="floehopping" alt="" /></p>
</div>

<div class="slide">
<h1>What?</h1>
</div>

<div class="slide">
<h1>What?</h1>
<ul>
	<li><span style="color:red;">RubyCocoa, MacRuby &amp; HotCocoa</span></li>
</ul>
</div>

<div class="slide">
<h1>What?</h1>
<ul>
	<li>RubyCocoa, MacRuby &amp; HotCocoa</li>
	<li><span style="color:red;">Disclaimer</span></li>
</ul>
</div>

<div class="slide">
<h1>What?</h1>
<ul>
	<li>RubyCocoa, MacRuby &amp; HotCocoa</li>
	<li>Disclaimer</li>
	<li><span style="color:red;">Getting Started</span></li>
</ul>
</div>

<div class="slide">
<h1>What?</h1>
<ul>
	<li>RubyCocoa, MacRuby &amp; HotCocoa</li>
	<li>Disclaimer</li>
	<li>Getting Started</li>
	<li><span style="color:red;">Acceptance Testing</span></li>
</ul>
</div>

<div class="slide">
<h1>What?</h1>
<ul>
	<li>RubyCocoa, MacRuby &amp; HotCocoa</li>
	<li>Disclaimer</li>
	<li>Getting Started</li>
	<li>Acceptance Testing</li>
	<li><span style="color:red;">Unit Testing</span></li>
</ul>
</div>

<div class="slide">
<h1>What?</h1>
<ul>
	<li>RubyCocoa, MacRuby &amp; HotCocoa</li>
	<li>Disclaimer</li>
	<li>Getting Started</li>
	<li>Acceptance Testing</li>
	<li>Unit Testing</li>
	<li><span style="color:red;">Questions</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices</h1>
<ul>
	<li>RubyCocoa</li>
	<li>MacRuby</li>
	<li>HotCocoa <em>(extension to MacRuby)</em></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; RubyCocoa</h1>
</div>

<div class="slide">
<h1>Choices &#8211; RubyCocoa</h1>
<ul>
	<li><span style="color:red;">Available on Leopard</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; RubyCocoa</h1>
<ul>
	<li>Available on Leopard</li>
	<li><span style="color:red;">Standard Ruby 1.8.6</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; RubyCocoa</h1>
<ul>
	<li>Available on Leopard</li>
	<li>Standard Ruby 1.8.6</li>
	<li><span style="color:red;">Bridge between Ruby &amp; Objective-C =&gt; slow</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; RubyCocoa</h1>
<ul>
	<li>Available on Leopard</li>
	<li>Standard Ruby 1.8.6</li>
	<li>Bridge between Ruby &amp; Objective-C =&gt; slow</li>
	<li><span style="color:red;">Ruby proxies of Objective-C objects</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; RubyCocoa</h1>
<ul>
	<li>Available on Leopard</li>
	<li>Standard Ruby 1.8.6</li>
	<li>Bridge between Ruby &amp; Objective-C =&gt; slow</li>
	<li>Ruby proxies of Objective-C objects</li>
	<li><span style="color:red;">No native threads</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; RubyCocoa</h1>
<ul>
	<li>Available on Leopard</li>
	<li>Standard Ruby 1.8.6</li>
	<li>Bridge between Ruby &amp; Objective-C =&gt; slow</li>
	<li>Ruby proxies of Objective-C objects</li>
	<li>No native threads</li>
	<li><span style="color:red;">Ruby source in app bundle</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; RubyCocoa</h1>
<ul>
	<li>Available on Leopard</li>
	<li>Standard Ruby 1.8.6</li>
	<li>Bridge between Ruby &amp; Objective-C =&gt; slow</li>
	<li>Ruby proxies of Objective-C objects</li>
	<li>No native threads</li>
	<li>Ruby source in app bundle</li>
	<li><span style="color:red;">Requires compatible Ruby i.e. at least Tiger</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; MacRuby</h1>
</div>

<div class="slide">
<h1>Choices &#8211; MacRuby</h1>
<ul>
	<li><span style="color:red;">Requires separate install</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; MacRuby</h1>
<ul>
	<li>Requires separate install</li>
	<li><span style="color:red;">Ruby 1.9 built on CoreFoundation/Objective-C</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; MacRuby</h1>
<ul>
	<li>Requires separate install</li>
	<li>Ruby 1.9 built on CoreFoundation/Objective-C</li>
	<li><span style="color:red;">Single runtime &amp; no bridge =&gt; much faster</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; MacRuby</h1>
<ul>
	<li>Requires separate install</li>
	<li>Ruby 1.9 built on CoreFoundation/Objective-C</li>
	<li>Single runtime &amp; no bridge =&gt; much faster</li>
	<li><span style="color:red;">Instance of Ruby <code>String</code> is <code>NSMutableString</code></span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; MacRuby</h1>
<ul>
	<li>Requires separate install</li>
	<li>Ruby 1.9 built on CoreFoundation/Objective-C</li>
	<li>Single runtime &amp; no bridge =&gt; much faster</li>
	<li>Instance of Ruby <code>String</code> is <code>NSMutableString</code></li>
	<li><span style="color:red;">Native threads</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; MacRuby</h1>
<ul>
	<li>Requires separate install</li>
	<li>Ruby 1.9 built on CoreFoundation/Objective-C</li>
	<li>Single runtime &amp; no bridge =&gt; much faster</li>
	<li>Instance of Ruby <code>String</code> is <code>NSMutableString</code></li>
	<li>Native threads</li>
	<li><span style="color:red;">Can compile Ruby in app bundle</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; MacRuby</h1>
<ul>
	<li>Requires separate install</li>
	<li>Ruby 1.9 built on CoreFoundation/Objective-C</li>
	<li>Single runtime &amp; no bridge =&gt; much faster</li>
	<li>Instance of Ruby <code>String</code> is <code>NSMutableString</code></li>
	<li>Native threads</li>
	<li>Can compile Ruby in app bundle</li>
	<li><span style="color:red;">Requires Objective-C 2.0 i.e. at least Leopard</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; HotCocoa</h1>
</div>

<div class="slide">
<h1>Choices &#8211; HotCocoa</h1>
<ul>
	<li><span style="color:red;">Comes with MacRuby</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; HotCocoa</h1>
<ul>
	<li>Comes with MacRuby</li>
	<li><span style="color:red;">Interface Builder killer</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; HotCocoa</h1>
<ul>
	<li>Comes with MacRuby</li>
	<li>Interface Builder killer</li>
	<li><span style="color:red;">Thin Ruby &#8220;layer&#8221;</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; HotCocoa</h1>
<ul>
	<li>Comes with MacRuby</li>
	<li>Interface Builder killer</li>
	<li>Thin Ruby &#8220;layer&#8221;</li>
	<li><span style="color:red;">Adds methods to Objective-C objects</span></li>
</ul>
</div>

<div class="slide">
<h1>Choices &#8211; HotCocoa</h1>
<ul>
	<li>Comes with MacRuby</li>
	<li>Interface Builder killer</li>
	<li>Thin Ruby &#8220;layer&#8221;</li>
	<li>Adds methods to Objective-C objects</li>
	<li><span style="color:red;">Sensible defaults</span></li>
</ul>
</div>

<div class="slide">
<h1>RubyCocoa irb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">&gt;&gt;</span> <span class="Keyword">require</span> <span class="String"><span class="String">'</span>osx/cocoa<span class="String">'</span></span>
=&gt; <span class="Constant">true</span>
 
</pre></div></div>
</div>

<div class="slide">
<h1>RubyCocoa irb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">&gt;&gt;</span> <span class="Keyword">require</span> <span class="String"><span class="String">'</span>osx/cocoa<span class="String">'</span></span>
=&gt; <span class="Constant">true</span>
 
<span class="Keyword">&gt;&gt;</span> <span class="String"><span class="String">'</span>hello<span class="String">'</span></span>.<span class="Entity">class</span>
=&gt; <span class="Variable">String</span>
 
</pre></div></div>
</div>

<div class="slide">
<h1>RubyCocoa irb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">&gt;&gt;</span> <span class="Keyword">require</span> <span class="String"><span class="String">'</span>osx/cocoa<span class="String">'</span></span>
=&gt; <span class="Constant">true</span>
 
<span class="Keyword">&gt;&gt;</span> <span class="String"><span class="String">'</span>hello<span class="String">'</span></span>.<span class="Entity">class</span>
=&gt; <span class="Variable">String</span>
 
<span class="Keyword">&gt;&gt;</span> hello <span class="Keyword">=</span> <span class="Variable">OSX</span>::<span class="Entity">NSString</span>.<span class="Entity">stringWithString</span>(<span class="String"><span class="String">'</span>hello<span class="String">'</span></span>)
=&gt; <span class="Comment"><span class="Comment">#</span>&lt;NSCFString &quot;hello&quot;&gt;</span>
 
</pre></div></div>
</div>

<div class="slide">
<h1>RubyCocoa irb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">&gt;&gt;</span> <span class="Keyword">require</span> <span class="String"><span class="String">'</span>osx/cocoa<span class="String">'</span></span>
=&gt; <span class="Constant">true</span>
 
<span class="Keyword">&gt;&gt;</span> <span class="String"><span class="String">'</span>hello<span class="String">'</span></span>.<span class="Entity">class</span>
=&gt; <span class="Variable">String</span>
 
<span class="Keyword">&gt;&gt;</span> hello <span class="Keyword">=</span> <span class="Variable">OSX</span>::<span class="Entity">NSString</span>.<span class="Entity">stringWithString</span>(<span class="String"><span class="String">'</span>hello<span class="String">'</span></span>)
=&gt; <span class="Comment"><span class="Comment">#</span>&lt;NSCFString &quot;hello&quot;&gt;</span>
 
<span class="Keyword">&gt;&gt;</span> hello.<span class="Entity">objc_methods</span>.<span class="Entity">select</span> { |<span class="Variable">m</span>| m <span class="Keyword">=~</span> <span class="StringRegexp"><span class="StringRegexp">/</span></span><span class="StringRegexp">caseString$</span><span class="StringRegexp"><span class="StringRegexp">/</span></span> }
=&gt; [<span class="String"><span class="String">&quot;</span>lowercaseString<span class="String">&quot;</span></span>, <span class="String"><span class="String">&quot;</span>uppercaseString<span class="String">&quot;</span></span>]
</pre></div></div>
</div>

<div class="slide">
<h1>MacRuby macirb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">&gt;&gt;</span> <span class="String"><span class="String">'</span>hello<span class="String">'</span></span>.<span class="Entity">class</span>
=&gt; <span class="Variable">NSMutableString</span>
 
</pre></div></div>
</div>

<div class="slide">
<h1>MacRuby macirb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">&gt;&gt;</span> <span class="String"><span class="String">'</span>hello<span class="String">'</span></span>.<span class="Entity">class</span>
=&gt; <span class="Variable">NSMutableString</span>
 
<span class="Keyword">&gt;&gt;</span> <span class="String"><span class="String">'</span>hello<span class="String">'</span></span>.<span class="Entity">methods</span>(<span class="Constant">true</span>, <span class="Constant">true</span>).<span class="Entity">select</span> { |<span class="Variable">m</span>| m <span class="Keyword">=~</span> <span class="StringRegexp"><span class="StringRegexp">/</span></span><span class="StringRegexp">caseString$</span><span class="StringRegexp"><span class="StringRegexp">/</span></span> }
=&gt; [<span class="Constant"><span class="Constant">:</span>lowercaseString</span>, <span class="Constant"><span class="Constant">:</span>uppercaseString</span>]
</pre></div></div>
</div>

<div class="slide">
<h1>Reading Objective-C</h1>
</div>

<div class="slide">
<h1>Reading Objective-C</h1>
<ul>
	<li><span style="color:red;">Explicit pointers</span></li>
</ul>
</div>

<div class="slide">
<h1>Reading Objective-C</h1>
<ul>
	<li>Explicit pointers</li>
	<li><span style="color:red;">Type declarations</span></li>
</ul>
</div>

<div class="slide">
<h1>Reading Objective-C</h1>
<ul>
	<li>Explicit pointers</li>
	<li>Type declarations</li>
	<li><span style="color:red;">Class interfaces &amp; implementations</span></li>
</ul>
</div>

<div class="slide">
<h1>Reading Objective-C</h1>
<ul>
	<li>Explicit pointers</li>
	<li>Type declarations</li>
	<li>Class interfaces &amp; implementations</li>
	<li><span style="color:red;">Sending messages</span></li>
</ul>
</div>

<div class="slide">
<h1>Method Calls (without parameters)</h1>
<h2>Objective-C</h2>
<div class="UltraViolet"><pre class="twilight"> 
 [sound <span class="SupportFunction">play</span>];
 
</pre></div></div>

<div class="slide">
<h1>Method Calls (without parameters)</h1>
<h2>Objective-C</h2>
<div class="UltraViolet"><pre class="twilight"> 
 [sound <span class="SupportFunction">play</span>];
 
</pre></div><h2>RubyCocoa</h2>
<div class="UltraViolet"><pre class="twilight"> 
 sound.<span class="Entity">play</span>
 
</pre></div></div>

<div class="slide">
<h1>Method Calls (without parameters)</h1>
<h2>Objective-C</h2>
<div class="UltraViolet"><pre class="twilight"> 
 [sound <span class="SupportFunction">play</span>];
 
</pre></div><h2>RubyCocoa</h2>
<div class="UltraViolet"><pre class="twilight"> 
 sound.<span class="Entity">play</span>
 
</pre></div><h2>MacRuby</h2>
<div class="UltraViolet"><pre class="twilight"> 
 sound.<span class="Entity">play</span>
 
</pre></div></div>

<div class="slide">
<h1>Method Calls (with parameters)</h1>
<h2>Objective-C</h2>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"> 
 <span class="Support">NSSound</span>* sound;
 sound = [sound <span class="SupportFunction">initWithContentsOfFile<span class="SupportFunction">:</span></span> <span class="String"><span class="String">@&quot;</span>my.mp3<span class="String">&quot;</span></span>
                <span class="SupportFunction">byReference<span class="SupportFunction">:</span></span> <span class="Constant">NO</span>
         ];
</pre></div></div>
</div>

<div class="slide">
<h1>Method Calls (with parameters)</h1>
<h2>Objective-C</h2>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"> 
 <span class="Support">NSSound</span>* sound;
 sound = [sound <span class="SupportFunction">initWithContentsOfFile<span class="SupportFunction">:</span></span> <span class="String"><span class="String">@&quot;</span>my.mp3<span class="String">&quot;</span></span>
                <span class="SupportFunction">byReference<span class="SupportFunction">:</span></span> <span class="Constant">NO</span>
         ];
</pre></div></div>
<h2>RubyCocoa</h2>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"> 
 sound <span class="Keyword">=</span> <span class="Variable">NSSound</span>.<span class="Entity">initWithContentsOfFile_byReference</span>(
   <span class="String"><span class="String">'</span>my.mp3<span class="String">'</span></span>,
   <span class="Constant">false</span>
 )
</pre></div></div>
</div>

<div class="slide">
<h1>Method Calls (with parameters)</h1>
<h2>Objective-C</h2>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"> 
 <span class="Support">NSSound</span>* sound;
 sound = [sound <span class="SupportFunction">initWithContentsOfFile<span class="SupportFunction">:</span></span> <span class="String"><span class="String">@&quot;</span>my.mp3<span class="String">&quot;</span></span>
                <span class="SupportFunction">byReference<span class="SupportFunction">:</span></span> <span class="Constant">NO</span>
         ];
</pre></div></div>
<h2>RubyCocoa</h2>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"> 
 sound <span class="Keyword">=</span> <span class="Variable">NSSound</span>.<span class="Entity">initWithContentsOfFile_byReference</span>(
   <span class="String"><span class="String">'</span>my.mp3<span class="String">'</span></span>,
   <span class="Constant">false</span>
 )
</pre></div></div>
<h2>MacRuby</h2>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"> 
 sound <span class="Keyword">=</span> <span class="Variable">NSSound</span>.<span class="Entity">initWithContentsOfFile</span>(
   <span class="String"><span class="String">'</span>my.mp3<span class="String">'</span></span>,
   byReference: <span class="Constant">false</span>
 )
</pre></div></div>
</div>

<div class="slide">
<h1>Objective-C &#8220;Hello World&#8221;</h1>
<div style="font-size: 40%">
<div class="UltraViolet"><pre class="twilight"><span class="CCCPreprocessorLine">#<span class="CCCPreprocessorDirective">import</span> <span class="String"><span class="String">&lt;</span>Cocoa/Cocoa.h<span class="String">&gt;</span></span></span>

<span class="Support">NSApplication</span> *app = [<span class="Support">NSApplication</span> <span class="SupportFunction">sharedApplication</span>]

<span class="Support">NSWindow</span> *window = [[<span class="Support">NSWindow</span> <span class="SupportFunction">alloc</span>] <span class="SupportFunction">initWithContentRect<span class="SupportFunction">:</span></span> <span class="SupportFunction">NSMakeRect</span>(<span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">200</span>, <span class="Constant">200</span>)
  <span class="SupportFunction">styleMask<span class="SupportFunction">:</span></span> <span class="SupportConstant">NSTitledWindowMask</span> | <span class="SupportConstant">NSClosableWindowMask</span> | <span class="SupportConstant">NSMiniaturizableWindowMask</span> | <span class="SupportConstant">NSResizableWindowMask</span>
  <span class="SupportFunction">backing<span class="SupportFunction">:</span></span> <span class="SupportConstant">NSBackingStoreBuffered</span>
  <span class="SupportFunction">defer<span class="SupportFunction">:</span></span> <span class="Constant">NO</span>
)
[window <span class="SupportFunction">setTitle<span class="SupportFunction">:</span></span> <span class="String"><span class="String">@&quot;</span>Hello World<span class="String">&quot;</span></span>]

<span class="Support">NSButton</span>* button = [[<span class="Support">NSButton</span> <span class="SupportFunction">alloc</span>] <span class="SupportFunction">initWithFrame<span class="SupportFunction">:</span></span> NSZeroRect]
[[window <span class="SupportFunction">contentView</span>] <span class="SupportFunction">addSubview<span class="SupportFunction">:</span></span> button]
[button <span class="SupportFunction">setBezelStyle<span class="SupportFunction">:</span></span> <span class="SupportConstant">NSRoundedBezelStyle</span>]
[button <span class="SupportFunction">setTitle<span class="SupportFunction">:</span></span> <span class="String"><span class="String">@&quot;</span>Say Hello<span class="String">&quot;</span></span>]
[button <span class="SupportFunction">sizeToFit</span>]
[button <span class="SupportFunction">setFrameOrigin<span class="SupportFunction">:</span></span> <span class="SupportFunction">NSMakePoint</span>(
  ([[[window <span class="SupportFunction">contentView</span>] <span class="SupportFunction">frameSize</span>] <span class="SupportFunction">width</span>] / <span class="Constant">2.0</span>) - ([[button <span class="SupportFunction">frameSize</span>] <span class="SupportFunction">width</span>] / <span class="Constant">2.0</span>),
  ([[[window <span class="SupportFunction">contentView</span>] <span class="SupportFunction">frameSize</span>] <span class="SupportFunction">height</span>] / <span class="Constant">2.0</span>) - ([[button <span class="SupportFunction">frameSize</span>] <span class="SupportFunction">height</span>] / <span class="Constant">2.0</span>)
)

<span class="Storage"><span class="Storage">@</span>interface</span> <span class="Entity">HelloWorldController</span> : <span class="EntityInheritedClass">NSObject</span> {
}
- (<span class="Storage">IBAction</span>)<span class="Entity">sayHello</span><span class="Entity"><span class="Entity">:</span></span>(<span class="Storage">id</span>)<span class="Variable">sender</span>;
<span class="Storage"><span class="Storage">@</span>end</span>

<span class="CCCPreprocessorLine">#<span class="CCCPreprocessorDirective">import</span> <span class="String"><span class="String">&quot;</span>HelloWorldController.h<span class="String">&quot;</span></span></span>

<span class="Storage"><span class="Storage">@</span>implementation</span> <span class="Entity">HelloWorldController</span>
- (<span class="Storage">IBAction</span>)<span class="Entity">sayHello</span><span class="Entity"><span class="Entity">:</span></span>(<span class="Storage">id</span>)<span class="Variable">sender</span>{
  <span class="SupportFunction">NSLog</span>(<span class="String"><span class="String">@&quot;</span>Hello World!<span class="String">&quot;</span></span>);
}
<span class="Storage"><span class="Storage">@</span>end</span>

HelloWorldController* controller = [[HelloWorldController <span class="SupportFunction">alloc</span>] <span class="SupportFunction">init</span>]
[button <span class="SupportFunction">setTarget<span class="SupportFunction">:</span></span> controller]
[button <span class="SupportFunction">setAction<span class="SupportFunction">:</span></span> <span class="Storage"><span class="Storage">@</span>selector</span>(<span class="SupportFunction">sayHello<span class="SupportFunction">:</span></span>)]

[window <span class="SupportFunction">display</span>]
[window <span class="SupportFunction">orderFrontRegardless</span>]

[app <span class="SupportFunction">run</span>]
</pre></div></div>
</div>

<div class="slide">
<h1>RubyCocoa &#8220;Hello World&#8221;</h1>
<div style="font-size: 40%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>osx/cocoa<span class="String">'</span></span>; <span class="Keyword">include</span> <span class="Variable">OSX</span>

app <span class="Keyword">=</span> <span class="Variable">NSApplication</span>.<span class="Entity">sharedApplication</span>

window <span class="Keyword">=</span> <span class="Variable">NSWindow</span>.<span class="Entity">alloc</span>.<span class="Entity">initWithContentRect_styleMask_backing_defer</span>(
  [<span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">200</span>, <span class="Constant">60</span>],
  <span class="Variable">NSTitledWindowMask</span> <span class="Keyword">|</span> <span class="Variable">NSClosableWindowMask</span> <span class="Keyword">|</span> <span class="Variable">NSMiniaturizableWindowMask</span> <span class="Keyword">|</span> <span class="Variable">NSResizableWindowMask</span>,
  <span class="Variable">NSBackingStoreBuffered</span>,
  <span class="Constant">false</span>
)
window.<span class="Entity">title</span> <span class="Keyword">=</span> <span class="String"><span class="String">'</span>Hello World<span class="String">'</span></span>

button <span class="Keyword">=</span> <span class="Variable">NSButton</span>.<span class="Entity">alloc</span>.<span class="Entity">initWithFrame</span>(<span class="Variable">NSZeroRect</span>)
window.<span class="Entity">contentView</span>.<span class="Entity">addSubview</span>(button)
button.<span class="Entity">bezelStyle</span> <span class="Keyword">=</span> <span class="Variable">NSRoundedBezelStyle</span>
button.<span class="Entity">title</span> <span class="Keyword">=</span> <span class="String"><span class="String">'</span>Say Hello<span class="String">'</span></span>
button.<span class="Entity">sizeToFit</span>
button.<span class="Entity">frameOrigin</span> <span class="Keyword">=</span> <span class="Variable">NSMakePoint</span>(
  (window.<span class="Entity">contentView</span>.<span class="Entity">frameSize</span>.<span class="Entity">width</span> <span class="Keyword">/</span> <span class="Constant">2.0</span>) <span class="Keyword">-</span> (button.<span class="Entity">frameSize</span>.<span class="Entity">width</span> <span class="Keyword">/</span> <span class="Constant">2.0</span>),
  (window.<span class="Entity">contentView</span>.<span class="Entity">frameSize</span>.<span class="Entity">height</span> <span class="Keyword">/</span> <span class="Constant">2.0</span>) <span class="Keyword">-</span> (button.<span class="Entity">frameSize</span>.<span class="Entity">height</span> <span class="Keyword">/</span> <span class="Constant">2.0</span>)
)

button_controller <span class="Keyword">=</span> <span class="Support">Object</span>.<span class="Entity">new</span>
<span class="Keyword">def</span> <span class="Entity">button_controller.sayHello</span>(<span class="Variable">sender</span>)
  <span class="Variable">NSLog</span>(<span class="String"><span class="String">'</span>Hello World!<span class="String">'</span></span>)
<span class="Keyword">end</span>
button.<span class="Entity">target</span> <span class="Keyword">=</span> button_controller
button.<span class="Entity">action</span> <span class="Keyword">=</span> <span class="String"><span class="String">'</span>sayHello:<span class="String">'</span></span>

window.<span class="Entity">display</span>
window.<span class="Entity">orderFrontRegardless</span>

app.<span class="Entity">run</span>
</pre></div></div>
</div>

<div class="slide">
<h1>MacRuby &#8220;Hello World&#8221;</h1>
<div style="font-size: 40%">
<div class="UltraViolet"><pre class="twilight">framework <span class="String"><span class="String">'</span>Cocoa<span class="String">'</span></span>

app <span class="Keyword">=</span> <span class="Variable">NSApplication</span>.<span class="Entity">sharedApplication</span>

window <span class="Keyword">=</span> <span class="Variable">NSWindow</span>.<span class="Entity">alloc</span>.<span class="Entity">initWithContentRect</span>(
  [<span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">200</span>, <span class="Constant">60</span>],
  styleMask<span class="Constant"><span class="Constant">:</span>NSTitledWindowMask</span> <span class="Keyword">|</span> <span class="Variable">NSClosableWindowMask</span> <span class="Keyword">|</span> <span class="Variable">NSMiniaturizableWindowMask</span> <span class="Keyword">|</span> <span class="Variable">NSResizableWindowMask</span>,
  backing<span class="Constant"><span class="Constant">:</span>NSBackingStoreBuffered</span>,
  defer<span class="Constant"><span class="Constant">:</span>false</span>
)
window.<span class="Entity">title</span> <span class="Keyword">=</span> <span class="String"><span class="String">'</span>Hello World<span class="String">'</span></span>

button <span class="Keyword">=</span> <span class="Variable">NSButton</span>.<span class="Entity">alloc</span>.<span class="Entity">initWithFrame</span>(<span class="Variable">NSZeroRect</span>)
window.<span class="Entity">contentView</span>.<span class="Entity">addSubview</span>(button)
button.<span class="Entity">bezelStyle</span> <span class="Keyword">=</span> <span class="Variable">NSRoundedBezelStyle</span>
button.<span class="Entity">title</span> <span class="Keyword">=</span> <span class="String"><span class="String">'</span>Say Hello<span class="String">'</span></span>
button.<span class="Entity">sizeToFit</span>
button.<span class="Entity">frameOrigin</span> <span class="Keyword">=</span> <span class="Variable">NSMakePoint</span>(
  (window.<span class="Entity">contentView</span>.<span class="Entity">frameSize</span>.<span class="Entity">width</span> <span class="Keyword">/</span> <span class="Constant">2.0</span>) <span class="Keyword">-</span> (button.<span class="Entity">frameSize</span>.<span class="Entity">width</span> <span class="Keyword">/</span> <span class="Constant">2.0</span>),
  (window.<span class="Entity">contentView</span>.<span class="Entity">frameSize</span>.<span class="Entity">height</span> <span class="Keyword">/</span> <span class="Constant">2.0</span>) <span class="Keyword">-</span> (button.<span class="Entity">frameSize</span>.<span class="Entity">height</span> <span class="Keyword">/</span> <span class="Constant">2.0</span>)
)

button_controller <span class="Keyword">=</span> <span class="Support">Object</span>.<span class="Entity">new</span>
<span class="Keyword">def</span> <span class="Entity">button_controller.sayHello</span>(<span class="Variable">sender</span>)
  <span class="Variable">NSLog</span>(<span class="String"><span class="String">'</span>Hello World!<span class="String">'</span></span>)
<span class="Keyword">end</span>
button.<span class="Entity">target</span> <span class="Keyword">=</span> button_controller
button.<span class="Entity">action</span> <span class="Keyword">=</span> <span class="String"><span class="String">'</span>sayHello:<span class="String">'</span></span>

window.<span class="Entity">display</span>
window.<span class="Entity">orderFrontRegardless</span>

app.<span class="Entity">run</span>
</pre></div></div>
</div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221;</h1>
<div style="font-size: 40%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>hotcocoa<span class="String">'</span></span>; <span class="Keyword">include</span> <span class="Variable">HotCocoa</span>

application <span class="Keyword">do</span>
  window <span class="Keyword">=</span> <span class="Entity">window</span>(<span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">'</span>Hello World<span class="String">'</span></span>, <span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">200</span>, <span class="Constant">60</span>])
  button <span class="Keyword">=</span> <span class="Entity">button</span>(<span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">'</span>Say Hello<span class="String">'</span></span>, <span class="Constant"><span class="Constant">:</span>layout</span> =&gt; { <span class="Constant"><span class="Constant">:</span>align</span> =&gt; <span class="Constant"><span class="Constant">:</span>centre</span> })
  button.<span class="Entity">on_action</span> { <span class="Variable">NSLog</span>(<span class="String"><span class="String">'</span>Hello World!<span class="String">'</span></span>) }
  window <span class="Keyword">&lt;&lt;</span> button
<span class="Keyword">end</span>
</pre></div></div>
</div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221;</h1>
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>hotcocoa<span class="String">'</span></span>; <span class="Keyword">include</span> <span class="Variable">HotCocoa</span>

application <span class="Keyword">do</span>
  window <span class="Keyword">=</span> <span class="Entity">window</span>(
    <span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">'</span>Hello World<span class="String">'</span></span>,
    <span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">200</span>, <span class="Constant">60</span>]
  )
  button <span class="Keyword">=</span> <span class="Entity">button</span>(
    <span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">'</span>Say Hello<span class="String">'</span></span>,
    <span class="Constant"><span class="Constant">:</span>layout</span> =&gt; { <span class="Constant"><span class="Constant">:</span>align</span> =&gt; <span class="Constant"><span class="Constant">:</span>centre</span> }
  )
  button.<span class="Entity">on_action</span> { <span class="Variable">NSLog</span>(<span class="String"><span class="String">'</span>Hello World!<span class="String">'</span></span>) }
  window <span class="Keyword">&lt;&lt;</span> button
<span class="Keyword">end</span>
</pre></div></div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221;</h1>
<div style="font-size: 80%">
<pre><code>+-helloworld/
  +-config/
  | +-build.yml
  +-lib/
  | +-application.rb
  | +-menu.rb
  +-Rakefile
  +-resources/
    +-smiley.icns</code></pre>
</div>
</div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221; &#8211; build.yml</h1>
<div style="font-size: 80%">
<pre><code>+-helloworld/
  +-config/
  | +-build.yml      &lt;-----
  +-lib/
  | +-application.rb
  | +-menu.rb
  +-Rakefile
  +-resources/
    +-smiley.icns</code></pre>
<div class="UltraViolet"><pre class="twilight"><span class="InvalidDeprecated"> </span>
<span class="String"><span class="MetaTagInline">name<span class="MetaTagInline">:</span></span> <span class="String">HelloWorld</span></span>
<span class="String"><span class="MetaTagInline">load<span class="MetaTagInline">:</span></span> <span class="String">lib/application.rb</span></span>
<span class="String"><span class="MetaTagInline">secure<span class="MetaTagInline">:</span></span> <span class="String">true</span></span>
<span class="MetaTagAll"><span class="MetaTagInline">version</span><span class="MetaTagAll">:</span> </span><span class="String"><span class="String">&quot;</span>1.0<span class="String">&quot;</span></span>
<span class="String"><span class="MetaTagInline">icon<span class="MetaTagInline">:</span></span> <span class="String">resources/smiley.icns</span></span>
<span class="MetaTagAll"><span class="MetaTagInline">sources</span><span class="MetaTagAll">:</span> </span>
  <span class="String"><span class="String">-</span> <span class="String">lib/**/*.rb</span></span>
<span class="InvalidDeprecated"> </span>
</pre></div></div>
</div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221; &#8211; application.rb</h1>
<div style="font-size: 80%">
<pre><code>+-helloworld/
  +-config/
  | +-build.yml
  +-lib/
  | +-application.rb &lt;-----
  | +-menu.rb
  +-Rakefile
  +-resources/
    +-smiley.icns</code></pre>
<div class="UltraViolet"><pre class="twilight"> 
<span class="Keyword">require</span> <span class="String"><span class="String">'</span>hotcocoa<span class="String">'</span></span>; <span class="Keyword">include</span> <span class="Variable">HotCocoa</span>
application <span class="Keyword">do</span>
  window <span class="Keyword">=</span> <span class="Entity">window</span>(
    <span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">'</span>Hello World<span class="String">'</span></span>,
    <span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">200</span>, <span class="Constant">60</span>]
  )
  button <span class="Keyword">=</span> <span class="Entity">button</span>(
    <span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">'</span>Say Hello<span class="String">'</span></span>,
    <span class="Constant"><span class="Constant">:</span>layout</span> =&gt; { <span class="Constant"><span class="Constant">:</span>align</span> =&gt; <span class="Constant"><span class="Constant">:</span>centre</span> }
  )
  button.<span class="Entity">on_action</span> { <span class="Variable">NSLog</span>(<span class="String"><span class="String">'</span>Hello World!<span class="String">'</span></span>) }
  window <span class="Keyword">&lt;&lt;</span> button
<span class="Keyword">end</span>
 
</pre></div></div>
</div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221; &#8211; menu.rb</h1>
<div style="font-size: 80%">
<pre><code>+-helloworld/
  +-config/
  | +-build.yml
  +-lib/
  | +-application.rb
  | +-menu.rb        &lt;-----
  +-Rakefile
  +-resources/
    +-smiley.icns</code></pre>
<div class="UltraViolet"><pre class="twilight"> 
<span class="Keyword">module</span> <span class="Entity">HotCocoa</span>
  <span class="Keyword">def</span> <span class="Entity">application_menu</span>
    menu <span class="Keyword">do </span>|<span class="Variable">main</span>|
      main.<span class="Entity">submenu</span> <span class="Constant"><span class="Constant">:</span>apple</span> <span class="Keyword">do </span>|<span class="Variable">apple</span>|
        apple.<span class="Entity">item</span>(<span class="Constant"><span class="Constant">:</span>quit</span>, {
          <span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">&quot;</span>Quit <span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span><span class="StringVariable">NSApp</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">name</span></span><span class="StringEmbeddedSource">}</span></span><span class="String">&quot;</span></span>,
          <span class="Constant"><span class="Constant">:</span>key</span> =&gt; <span class="String"><span class="String">&quot;</span>q<span class="String">&quot;</span></span>
        })
      <span class="Keyword">end</span>
    <span class="Keyword">end</span>
  <span class="Keyword">end</span>
<span class="Keyword">end</span>
 
</pre></div></div>
</div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221; &#8211; Rakefile</h1>
<div style="font-size: 80%">
<pre><code>+-helloworld/
  +-config/
  | +-build.yml
  +-lib/
  | +-application.rb
  | +-menu.rb
  +-Rakefile         &lt;-----
  +-resources/
    +-smiley.icns</code></pre>
<div class="UltraViolet"><pre class="twilight"> 
<span class="Keyword">require</span> <span class="String"><span class="String">'</span>hotcocoa/application_builder<span class="String">'</span></span>
<span class="Keyword">require</span> <span class="String"><span class="String">'</span>hotcocoa/standard_rake_tasks<span class="String">'</span></span>

task <span class="Constant"><span class="Constant">:</span>default</span> =&gt; [<span class="Constant"><span class="Constant">:</span>run</span>]
 
</pre></div><div class="UltraViolet"><pre class="twilight"> 
macrake clean   <span class="Comment"><span class="Comment">#</span> Delete app bundle</span>
macrake build   <span class="Comment"><span class="Comment">#</span> Build app bundle</span>
macrake run     <span class="Comment"><span class="Comment">#</span> Build &amp; run app bundle</span>
macrake deploy  <span class="Comment"><span class="Comment">#</span> Build app bundle and embed MacRuby.framework</span>
 
</pre></div></div>
</div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221; &#8211; smiley.icns</h1>
<div style="font-size: 80%">
<pre><code>+-helloworld/
  +-config/
  | +-build.yml
  +-lib/
  | +-application.rb
  | +-menu.rb
  +-Rakefile
  +-resources/
    +-smiley.icns    &lt;-----</code></pre>
</div>
<p><img src="images/smiley.jpg" alt="" /></p>
</div>

<div class="slide">
<h1>HotCocoa &#8220;Hello World&#8221; Demo</h1>
<pre>
 
# DO THE DEMO
 
$ macrake deploy

$ macrake run
 
</pre>
</div>

<div class="slide">
<h1>Anatomy of &#8220;Hello World&#8221; App Bundle</h1>
<div style="font-size: 80%">
<pre><code>+-helloworld
  +-HelloWorld.app/
    +-Contents
      +-Frameworks
      | +-MacRuby.framework # Embedded
      +-Info.plist          # Metadata
      +-MacOS
      | +-HelloWorld        # Binary
      +-PkgInfo             # Metadata
      +-Resources
        +-HelloWorld.icns   # Icons
        +-rb_main.rb        # MacRuby app loader
        +-vfs.db            # Virtual FS database</code></pre>
</div>
</div>

<div class="slide">
<h1>installd.com &#8211; Website</h1>
<p><img src="images/installd-screenshot.jpg" class="installd screenshot" alt="" /></p>
</div>

<div class="slide">
<h1>installd.com &#8211; PreferencePane</h1>
<p><img src="images/installd-preference-pane.jpg" class="installd preferencepane" alt="" /></p>
</div>

<div class="slide">
<h1>Universal Access</h1>
<p><img src="images/universal-access.png" class="universalaccess" alt="" /></p>
</div>

<div class="slide">
<h1>HotCocoa Calculator</h1>
<p><img src="images/calculator.jpg" class="calculator" alt="" /></p>
</div>

<div class="slide">
<h1>CalculatorDriver &#8211; Setup</h1>
<div style="font-size: 85%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>appscript<span class="String">'</span></span>

<span class="Keyword">module</span> <span class="Entity">CalculatorDriver</span>
  
  <span class="Keyword">include</span> <span class="Variable">Appscript</span>
  
  <span class="Keyword">def</span> <span class="Entity">activate_calculator_app</span>
    app_path <span class="Keyword">=</span> <span class="Support">File</span>.<span class="Entity">expand_path</span>(...)
    <span class="Entity">app</span>(app_path).<span class="Entity">activate</span>
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">calculator_process</span>
    system_events <span class="Keyword">=</span> <span class="Entity">app</span>(<span class="String"><span class="String">'</span>System Events<span class="String">'</span></span>)
    system_events.<span class="Entity">processes</span>[<span class="String"><span class="String">'</span>Calculator<span class="String">'</span></span>]
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">setup_calculator_driver</span>
    activate_calculator_app
    window <span class="Keyword">=</span> calculator_process.<span class="Entity">windows</span>[<span class="String"><span class="String">'</span>Calculator<span class="String">'</span></span>]
    <span class="Variable"><span class="Variable">@</span>buttons</span> <span class="Keyword">=</span> window.<span class="Entity">buttons</span>
    <span class="Variable"><span class="Variable">@</span>text_fields</span> <span class="Keyword">=</span> window.<span class="Entity">text_fields</span>
  <span class="Keyword">end</span>
  
<span class="Comment">  <span class="Comment">#</span>...</span>
</pre></div></div>
</div>

<div class="slide">
<h1>CalculatorDriver &#8211; Clicks</h1>
<div style="font-size: 85%">
<div class="UltraViolet"><pre class="twilight"> 
  <span class="Keyword">def</span> <span class="Entity">input_with_buttons</span>(<span class="Variable">buttons_text</span>)
    buttons_text.<span class="Entity">each_byte</span> <span class="Keyword">do </span>|<span class="Variable">byte</span>|
      <span class="Entity">click_button</span>(byte.<span class="Entity">chr</span>)
    <span class="Keyword">end</span>
  <span class="Keyword">end</span>

  <span class="Keyword">def</span> <span class="Entity">click_button</span>(<span class="Variable">character</span>)
    buttons <span class="Keyword">=</span> <span class="String"><span class="String">%w(</span>C 0 1 2 3 4 5 6 7 8 9 . + - * / = √<span class="String">)</span></span>
    <span class="Keyword">if</span> buttons.<span class="Entity">include?</span>(character)
      <span class="Variable"><span class="Variable">@</span>buttons</span>[character].<span class="Entity">click</span>
    <span class="Keyword">else</span>
      <span class="Keyword">raise</span> <span class="String"><span class="String">&quot;</span>Button does not exist for: <span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span>character<span class="StringEmbeddedSource">}</span></span><span class="String">&quot;</span></span>
    <span class="Keyword">end</span>
  <span class="Keyword">end</span>
  
<span class="Comment">  <span class="Comment">#</span>...</span>
  
</pre></div></div>
</div>

<div class="slide">
<h1>CalculatorDriver &#8211; Assertion</h1>
<div style="font-size: 85%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>test/unit/assertions<span class="String">'</span></span>

<span class="Comment">  <span class="Comment">#</span>...</span>
  
  <span class="Keyword">include</span> <span class="Support">Test</span>::<span class="Entity">Unit</span>::<span class="Entity">Assertions</span>
  
  <span class="Keyword">def</span> <span class="Entity">displays_number</span>(<span class="Variable">expected_result</span>)
    result <span class="Keyword">=</span> <span class="Variable"><span class="Variable">@</span>text_fields</span>[<span class="Constant">1</span>].<span class="Entity">value</span>.<span class="Entity">get</span>
    assert_equal expected_result, result
  <span class="Keyword">end</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; UIElementInspector</h1>
<p><img src="images/ui-element-inspector.jpg" class="uielementinspector" alt="" /></p>
</div>

<div class="slide">
<h1>Calculator &#8211; Acceptance Test</h1>
<div style="font-size: 85%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>test/unit<span class="String">'</span></span>
<span class="Keyword">require</span> <span class="String"><span class="String">'</span>calculator_driver<span class="String">'</span></span>

<span class="Keyword">class</span> <span class="Entity">AdditionTest<span class="EntityInheritedClass"> <span class="EntityInheritedClass">&lt;</span> Test::Unit::TestCase</span></span>

  <span class="Keyword">include</span> <span class="Variable">CalculatorDriver</span>
  
  <span class="Keyword">def</span> <span class="Entity">setup</span>
    setup_calculator_driver
    <span class="Entity">click_button</span>(<span class="String"><span class="String">'</span>C<span class="String">'</span></span>)
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">test_adding_two_single_digit_numbers</span>
    <span class="Entity">input_with_buttons</span>(<span class="String"><span class="String">'</span>1<span class="String">'</span></span>)
    <span class="Entity">click_button</span>(<span class="String"><span class="String">'</span>+<span class="String">'</span></span>)
    <span class="Entity">input_with_buttons</span>(<span class="String"><span class="String">'</span>2<span class="String">'</span></span>)
    <span class="Entity">click_button</span>(<span class="String"><span class="String">'</span>=<span class="String">'</span></span>)
    
    <span class="Entity">displays_number</span>(<span class="String"><span class="String">'</span>3<span class="String">'</span></span>)
  <span class="Keyword">end</span>
  
<span class="Comment">  <span class="Comment">#</span>...</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; Run Acceptance Tests</h1>
<pre>
 
# DO THE DEMO
 
$ macrake build

$ rake test:acceptance
 
</pre>
</div>

<div class="slide">
<h1>Calculator &#8211; application.rb</h1>
<div style="font-size: 20%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">require</span> <span class="String"><span class="String">'</span>hotcocoa<span class="String">'</span></span>

<span class="Keyword">include</span> <span class="Variable">HotCocoa</span>

<span class="Keyword">class</span> <span class="Entity">Calculator</span>

  <span class="Keyword">def</span> <span class="Entity">self.on</span>
    <span class="Variable">self</span>.<span class="Entity">new</span>.<span class="Entity">show</span>
  <span class="Keyword">end</span>

  <span class="Keyword">attr_accessor</span> <span class="Constant"><span class="Constant">:</span>accumulator</span>, <span class="Constant"><span class="Constant">:</span>value</span>, <span class="Constant"><span class="Constant">:</span>operand_pressed</span>, <span class="Constant"><span class="Constant">:</span>button_view</span>

  <span class="Keyword">def</span> <span class="Entity">initialize</span>
    <span class="Variable"><span class="Variable">@</span>accumulator</span> <span class="Keyword">=</span> []
  <span class="Keyword">end</span>

  <span class="Keyword">def</span> <span class="Entity">show</span>
    application <span class="Constant"><span class="Constant">:</span>name</span> =&gt; <span class="String"><span class="String">&quot;</span>Calculator<span class="String">&quot;</span></span> <span class="Keyword">do </span>|<span class="Variable">app</span>|
      main_window <span class="Keyword">&lt;&lt;</span> value
      main_window <span class="Keyword">&lt;&lt;</span> button_view
      main_window.<span class="Entity">will_close</span> { exit }
    <span class="Keyword">end</span>
  <span class="Keyword">end</span>

  <span class="Keyword">private</span>

    <span class="Keyword">def</span> <span class="Entity">main_window</span>(<span class="Variable"><span class="Keyword">&amp;</span>block</span>)
      <span class="Variable"><span class="Variable">@</span>main_window</span> <span class="Keyword">||=</span> <span class="Entity">window</span>(<span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">100</span>, <span class="Constant">800</span>, <span class="Constant">220</span>, <span class="Constant">280</span>], <span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">&quot;</span>Calculator<span class="String">&quot;</span></span>, <span class="Constant"><span class="Constant">:</span>view</span> =&gt; <span class="Constant"><span class="Constant">:</span>nolayout</span>, <span class="Constant"><span class="Constant">:</span>style</span> =&gt; [<span class="Constant"><span class="Constant">:</span>titled</span>, <span class="Constant"><span class="Constant">:</span>closable</span>, <span class="Constant"><span class="Constant">:</span>miniaturizable</span>], <span class="Keyword">&amp;</span>block)
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">value</span>
      <span class="Variable"><span class="Variable">@</span>value</span> <span class="Keyword">||=</span> <span class="Entity">text_field</span>(<span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">10</span>, <span class="Constant">230</span>, <span class="Constant">200</span>, <span class="Constant">40</span>], <span class="Constant"><span class="Constant">:</span>text</span> =&gt; <span class="String"><span class="String">&quot;</span>0<span class="String">&quot;</span></span>, <span class="Constant"><span class="Constant">:</span>font</span> =&gt; <span class="Entity">font</span>(<span class="Constant"><span class="Constant">:</span>name</span> =&gt; <span class="String"><span class="String">&quot;</span>Tahoma<span class="String">&quot;</span></span>, <span class="Constant"><span class="Constant">:</span>size</span> =&gt; <span class="Constant">22</span>), <span class="Constant"><span class="Constant">:</span>text_align</span> =&gt; <span class="Constant"><span class="Constant">:</span>right</span>)
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">button_view</span>
      <span class="Variable"><span class="Variable">@</span>button_view</span> <span class="Keyword">||</span> create_button_view
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">create_button_view</span>
      <span class="Variable"><span class="Variable">@</span>button_view</span> <span class="Keyword">=</span> <span class="Entity">view</span>(<span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">10</span>, <span class="Constant">10</span>, <span class="Constant">200</span>, <span class="Constant">240</span>])
      add_buttons
      <span class="Variable"><span class="Variable">@</span>button_view</span>
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">add_buttons</span>
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>CL<span class="String">&quot;</span></span>,  <span class="Constant">0</span>, <span class="Constant">4</span>)         { clear }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>SQR<span class="String">&quot;</span></span>, <span class="Constant">1</span>, <span class="Constant">4</span>)         { sqrt }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>/<span class="String">&quot;</span></span>,   <span class="Constant">2</span>, <span class="Constant">4</span>)         { operand <span class="Constant"><span class="Constant">:</span>/</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>*<span class="String">&quot;</span></span>,   <span class="Constant">3</span>, <span class="Constant">4</span>)         { operand <span class="Constant"><span class="Constant">:</span>*</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>7<span class="String">&quot;</span></span>,   <span class="Constant">0</span>, <span class="Constant">3</span>)         { press <span class="Constant">7</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>8<span class="String">&quot;</span></span>,   <span class="Constant">1</span>, <span class="Constant">3</span>)         { press <span class="Constant">8</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>9<span class="String">&quot;</span></span>,   <span class="Constant">2</span>, <span class="Constant">3</span>)         { press <span class="Constant">9</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>-<span class="String">&quot;</span></span>,   <span class="Constant">3</span>, <span class="Constant">3</span>)         { operand <span class="Constant"><span class="Constant">:</span>-</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>4<span class="String">&quot;</span></span>,   <span class="Constant">0</span>, <span class="Constant">2</span>)         { press <span class="Constant">4</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>5<span class="String">&quot;</span></span>,   <span class="Constant">1</span>, <span class="Constant">2</span>)         { press <span class="Constant">5</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>6<span class="String">&quot;</span></span>,   <span class="Constant">2</span>, <span class="Constant">2</span>)         { press <span class="Constant">6</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>+<span class="String">&quot;</span></span>,   <span class="Constant">3</span>, <span class="Constant">2</span>)         { operand <span class="Constant"><span class="Constant">:</span>+</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>1<span class="String">&quot;</span></span>,   <span class="Constant">0</span>, <span class="Constant">1</span>)         { press <span class="Constant">1</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>2<span class="String">&quot;</span></span>,   <span class="Constant">1</span>, <span class="Constant">1</span>)         { press <span class="Constant">2</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>3<span class="String">&quot;</span></span>,   <span class="Constant">2</span>, <span class="Constant">1</span>)         { press <span class="Constant">3</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>=<span class="String">&quot;</span></span>,   <span class="Constant">3</span>, <span class="Constant">1</span>, <span class="Constant">0</span>, <span class="Constant">1</span>)   { evaluate }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>0<span class="String">&quot;</span></span>,   <span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">1</span>, <span class="Constant">0</span>)   { press <span class="Constant">0</span> }
      <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>.<span class="String">&quot;</span></span>,   <span class="Constant">2</span>, <span class="Constant">0</span>)         { press <span class="String"><span class="String">'</span>.<span class="String">'</span></span> }
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">calc_button</span>(<span class="Variable">name<span class="Variable">,</span> x<span class="Variable">,</span> y<span class="Variable">,</span> w<span class="Keyword">=</span><span class="Constant">0</span><span class="Variable">,</span> h<span class="Keyword">=</span><span class="Constant">0</span><span class="Variable">,</span> <span class="Keyword">&amp;</span>block</span>)
      button_view <span class="Keyword">&lt;&lt;</span> <span class="Entity">button</span>(<span class="Constant"><span class="Constant">:</span>title</span> =&gt; name, <span class="Constant"><span class="Constant">:</span>bezel</span> =&gt; <span class="Constant"><span class="Constant">:</span>regular_square</span>, <span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [x<span class="Keyword">*</span><span class="Constant">50</span>, y<span class="Keyword">*</span><span class="Constant">43</span><span class="Keyword">-</span>h<span class="Keyword">*</span><span class="Constant">43</span>, <span class="Constant">47</span><span class="Keyword">+</span>w<span class="Keyword">*</span><span class="Constant">50</span>, <span class="Constant">40</span><span class="Keyword">+</span>h<span class="Keyword">*</span><span class="Constant">43</span>]).<span class="Entity">on_action</span>(<span class="Keyword">&amp;</span>block)
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">evaluate</span>
      accumulator <span class="Keyword">&lt;&lt;</span> float_value
      result <span class="Keyword">=</span> <span class="Entity">eval</span>(accumulator.<span class="Entity">join</span>(<span class="String"><span class="String">&quot;</span> <span class="String">&quot;</span></span>))
      value.<span class="Entity">text</span> <span class="Keyword">=</span> (result.<span class="Entity">to_i</span> <span class="Keyword">==</span> result <span class="Keyword">?</span> result.<span class="Entity">to_i</span> : result.<span class="Entity">to_s</span>)
      accumulator.<span class="Entity">clear</span>
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">press</span>(<span class="Variable">key</span>)
      <span class="Keyword">if</span> operand_pressed
        value.<span class="Entity">text</span> <span class="Keyword">=</span> key.<span class="Entity">to_s</span>
      <span class="Keyword">else</span>
        value.<span class="Entity">text</span> <span class="Keyword">=</span> (value.<span class="Entity">to_s</span> <span class="Keyword">==</span> <span class="String"><span class="String">&quot;</span>0<span class="String">&quot;</span></span> <span class="Keyword">?</span> key.<span class="Entity">to_s</span> : (value.<span class="Entity">to_s</span> <span class="Keyword">+</span> key.<span class="Entity">to_s</span>))
      <span class="Keyword">end</span>
      <span class="Variable"><span class="Variable">@</span>operand_pressed</span> <span class="Keyword">=</span> <span class="Constant">false</span>
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">operand</span>(<span class="Variable">key</span>)
      accumulator <span class="Keyword">&lt;&lt;</span> float_value
      accumulator <span class="Keyword">&lt;&lt;</span> key
      <span class="Variable"><span class="Variable">@</span>operand_pressed</span> <span class="Keyword">=</span> <span class="Constant">true</span>
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">float_value</span>
      (value.<span class="Entity">to_s</span>[<span class="Constant">0</span>,<span class="Constant">1</span>] <span class="Keyword">==</span> <span class="String"><span class="String">&quot;</span>.<span class="String">&quot;</span></span> <span class="Keyword">?</span> <span class="String"><span class="String">&quot;</span>0<span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span>value<span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">to_s</span></span><span class="StringEmbeddedSource">}</span></span><span class="String">&quot;</span></span> : value.<span class="Entity">to_s</span>).<span class="Entity">to_f</span>
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">sqrt</span>
      value.<span class="Entity">text</span> <span class="Keyword">=</span> <span class="Support">Math</span>.<span class="Entity">sqrt</span>(float_value).<span class="Entity">to_s</span>
    <span class="Keyword">end</span>

    <span class="Keyword">def</span> <span class="Entity">clear</span>
      value.<span class="Entity">text</span> <span class="Keyword">=</span> <span class="String"><span class="String">&quot;</span>0<span class="String">&quot;</span></span>
    <span class="Keyword">end</span>

<span class="Keyword">end</span>

<span class="Support">Calculator</span>.<span class="Entity">on</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; display.rb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">class</span> <span class="Entity">Display</span>
  
  <span class="Keyword">def</span> <span class="Entity">initialize</span>
    clear
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">clear</span>
    <span class="Variable"><span class="Variable">@</span>value</span> <span class="Keyword">=</span> <span class="String"><span class="String">'</span>0<span class="String">'</span></span>
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">set</span>(<span class="Variable">value</span>)
    <span class="Variable"><span class="Variable">@</span>value</span> <span class="Keyword">=</span> value.<span class="Entity">to_s</span>
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">push</span>(<span class="Variable">character</span>)
    <span class="Keyword">if</span> <span class="Variable"><span class="Variable">@</span>value</span> <span class="Keyword">==</span> <span class="String"><span class="String">'</span>0<span class="String">'</span></span>
      <span class="Variable"><span class="Variable">@</span>value</span> <span class="Keyword">=</span> character
    <span class="Keyword">else</span>
      <span class="Variable"><span class="Variable">@</span>value</span> <span class="Keyword">+=</span> character
    <span class="Keyword">end</span>
  <span class="Keyword">end</span>
  
<span class="Comment">  <span class="Comment">#</span>...</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; display_test.rb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">class</span> <span class="Entity">DisplayTest<span class="EntityInheritedClass"> <span class="EntityInheritedClass">&lt;</span> Test::Unit::TestCase</span></span>
  
  <span class="Keyword">def</span> <span class="Entity">test_initial_value</span>
    assert_equal <span class="String"><span class="String">'</span>0<span class="String">'</span></span>, <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">to_s</span>
    assert_in_delta <span class="Constant">0.0</span>, <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">to_f</span>, <span class="Constant">1e-8</span>
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">test_clear_value</span>
    <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">push</span>(<span class="String"><span class="String">'</span>1<span class="String">'</span></span>)
    <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">clear</span>
    assert_equal <span class="String"><span class="String">'</span>0<span class="String">'</span></span>, <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">to_s</span>
    assert_in_delta <span class="Constant">0.0</span>, <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">to_f</span>, <span class="Constant">1e-8</span>
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">test_entering_single_digit_number</span>
    <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">push</span>(<span class="String"><span class="String">'</span>1<span class="String">'</span></span>)
    assert_equal <span class="String"><span class="String">'</span>1<span class="String">'</span></span>, <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">to_s</span>
    assert_in_delta <span class="Constant">1.0</span>, <span class="Variable"><span class="Variable">@</span>display</span>.<span class="Entity">to_f</span>, <span class="Constant">1e-8</span>
  <span class="Keyword">end</span>
  
<span class="Comment">  <span class="Comment">#</span>...</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; accumulator.rb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">class</span> <span class="Entity">Accumulator</span>
  
  <span class="Keyword">def</span> <span class="Entity">initialize</span>
    clear
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">push</span>(<span class="Variable">value</span>)
    <span class="Variable"><span class="Variable">@</span>values</span> <span class="Keyword">&lt;&lt;</span> value
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">evaluate</span>
    result <span class="Keyword">=</span> <span class="Entity">eval</span>(<span class="Variable"><span class="Variable">@</span>values</span>.<span class="Entity">join</span>(<span class="String"><span class="String">'</span> <span class="String">'</span></span>)).<span class="Entity">to_f</span>
    clear
    result
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">clear</span>
    <span class="Variable"><span class="Variable">@</span>values</span> <span class="Keyword">=</span> []
  <span class="Keyword">end</span>
  
<span class="Comment">  <span class="Comment">#</span>...</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; view.rb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">class</span> <span class="Entity">View</span>
  
  <span class="Keyword">attr_reader</span> <span class="Constant"><span class="Constant">:</span>buttons</span>
  
  <span class="Keyword">def</span> <span class="Entity">initialize</span>(<span class="Variable">controller</span>)
    main_window <span class="Keyword">=</span> <span class="Entity">window</span>(
      <span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">100</span>, <span class="Constant">800</span>, <span class="Constant">220</span>, <span class="Constant">280</span>],
      <span class="Constant"><span class="Constant">:</span>title</span> =&gt; <span class="String"><span class="String">&quot;</span>Calculator<span class="String">&quot;</span></span>,
      <span class="Constant"><span class="Constant">:</span>view</span> =&gt; <span class="Constant"><span class="Constant">:</span>nolayout</span>,
      <span class="Constant"><span class="Constant">:</span>style</span> =&gt; [<span class="Constant"><span class="Constant">:</span>titled</span>, <span class="Constant"><span class="Constant">:</span>closable</span>, <span class="Constant"><span class="Constant">:</span>miniaturizable</span>]
    )
    
    <span class="Variable"><span class="Variable">@</span>value</span> <span class="Keyword">=</span> <span class="Entity">text_field</span>(
      <span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">10</span>, <span class="Constant">230</span>, <span class="Constant">200</span>, <span class="Constant">40</span>],
      <span class="Constant"><span class="Constant">:</span>text</span> =&gt; controller.<span class="Entity">display</span>.<span class="Entity">to_s</span>,
      <span class="Constant"><span class="Constant">:</span>font</span> =&gt; <span class="Entity">font</span>(<span class="Constant"><span class="Constant">:</span>name</span> =&gt; <span class="String"><span class="String">&quot;</span>Tahoma<span class="String">&quot;</span></span>, <span class="Constant"><span class="Constant">:</span>size</span> =&gt; <span class="Constant">22</span>),
      <span class="Constant"><span class="Constant">:</span>text_align</span> =&gt; <span class="Constant"><span class="Constant">:</span>right</span>
    )
    main_window <span class="Keyword">&lt;&lt;</span> <span class="Variable"><span class="Variable">@</span>value</span>
    
<span class="Comment">    <span class="Comment">#</span>...</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; view.rb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Comment">    <span class="Comment">#</span>...</span>
    
    <span class="Variable"><span class="Variable">@</span>buttons</span> <span class="Keyword">=</span> {}
    <span class="Variable"><span class="Variable">@</span>buttons</span>[<span class="String"><span class="String">'</span>C<span class="String">'</span></span>] <span class="Keyword">=</span> <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>C<span class="String">&quot;</span></span>, <span class="Constant">0</span>, <span class="Constant">4</span>)
    <span class="Variable"><span class="Variable">@</span>buttons</span>[<span class="String"><span class="String">'</span>√<span class="String">'</span></span>] <span class="Keyword">=</span> <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>√<span class="String">&quot;</span></span>, <span class="Constant">1</span>, <span class="Constant">4</span>)
    <span class="Variable"><span class="Variable">@</span>buttons</span>[<span class="String"><span class="String">'</span>/<span class="String">'</span></span>] <span class="Keyword">=</span> <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>/<span class="String">&quot;</span></span>, <span class="Constant">2</span>, <span class="Constant">4</span>)
    
<span class="Comment">    <span class="Comment">#</span>...</span>
    
    <span class="Variable"><span class="Variable">@</span>buttons</span>[<span class="String"><span class="String">'</span>=<span class="String">'</span></span>] <span class="Keyword">=</span> <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>=<span class="String">&quot;</span></span>, <span class="Constant">3</span>, <span class="Constant">1</span>, <span class="Constant">0</span>, <span class="Constant">1</span>)
    <span class="Variable"><span class="Variable">@</span>buttons</span>[<span class="String"><span class="String">'</span>0<span class="String">'</span></span>] <span class="Keyword">=</span> <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>0<span class="String">&quot;</span></span>, <span class="Constant">0</span>, <span class="Constant">0</span>, <span class="Constant">1</span>, <span class="Constant">0</span>)
    <span class="Variable"><span class="Variable">@</span>buttons</span>[<span class="String"><span class="String">'</span>.<span class="String">'</span></span>] <span class="Keyword">=</span> <span class="Entity">calc_button</span>(<span class="String"><span class="String">&quot;</span>.<span class="String">&quot;</span></span>, <span class="Constant">2</span>, <span class="Constant">0</span>)
    
    buttons_view <span class="Keyword">=</span> <span class="Entity">view</span>(<span class="Constant"><span class="Constant">:</span>frame</span> =&gt; [<span class="Constant">10</span>, <span class="Constant">10</span>, <span class="Constant">200</span>, <span class="Constant">240</span>])
    <span class="Variable"><span class="Variable">@</span>buttons</span>.<span class="Entity">values</span>.<span class="Entity">each</span> <span class="Keyword">do </span>|<span class="Variable">b</span>|
      buttons_view <span class="Keyword">&lt;&lt;</span> b
    <span class="Keyword">end</span>
    main_window <span class="Keyword">&lt;&lt;</span> buttons_view
    main_window.<span class="Entity">will_close</span> { exit }
  <span class="Keyword">end</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; accumulator_test.rb</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">class</span> <span class="Entity">AccumulatorTest<span class="EntityInheritedClass"> <span class="EntityInheritedClass">&lt;</span> Test::Unit::TestCase</span></span>

  <span class="Keyword">def</span> <span class="Entity">test_initial_evaluate</span>
    result <span class="Keyword">=</span> <span class="Variable"><span class="Variable">@</span>accumulator</span>.<span class="Entity">evaluate</span>
    assert_in_delta <span class="Constant">0.0</span>, result, <span class="Constant">1e-8</span>
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">test_evaluate_after_no_operations</span>
    <span class="Variable"><span class="Variable">@</span>accumulator</span>.<span class="Entity">push</span>(<span class="Constant">123.0</span>)
    result <span class="Keyword">=</span> <span class="Variable"><span class="Variable">@</span>accumulator</span>.<span class="Entity">evaluate</span>
    assert_in_delta <span class="Constant">123.0</span>, result, <span class="Constant">1e-8</span>
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">test_evaluate_addition_operation</span>
    <span class="Variable"><span class="Variable">@</span>accumulator</span>.<span class="Entity">push</span>(<span class="Constant">123.0</span>)
    <span class="Variable"><span class="Variable">@</span>accumulator</span>.<span class="Entity">push</span>(<span class="String"><span class="String">'</span>+<span class="String">'</span></span>)
    <span class="Variable"><span class="Variable">@</span>accumulator</span>.<span class="Entity">push</span>(<span class="Constant">456.0</span>)
    result <span class="Keyword">=</span> <span class="Variable"><span class="Variable">@</span>accumulator</span>.<span class="Entity">evaluate</span>
    assert_in_delta <span class="Constant">579.0</span>, result, <span class="Constant">1e-8</span>
  <span class="Keyword">end</span>
  
<span class="Comment">  <span class="Comment">#</span>...</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; application.rb (refactored)</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight"><span class="Keyword">class</span> <span class="Entity">Calculator</span>
  
  <span class="Keyword">def</span> <span class="Entity">initialize</span>
    <span class="Variable"><span class="Variable">@</span>model</span> <span class="Keyword">=</span> <span class="Support">Model</span>.<span class="Entity">new</span>
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">show</span>
    application <span class="Constant"><span class="Constant">:</span>name</span> =&gt; <span class="String"><span class="String">&quot;</span>Calculator<span class="String">&quot;</span></span> <span class="Keyword">do </span>|<span class="Variable">app</span>|
      <span class="Variable"><span class="Variable">@</span>view</span> <span class="Keyword">=</span> <span class="Support">View</span>.<span class="Entity">new</span>(<span class="Variable">self</span>)
      <span class="String"><span class="String">%w(</span>0 1 2 3 4 5 6 7 8 9 .<span class="String">)</span></span>.<span class="Entity">each</span> <span class="Keyword">do </span>|<span class="Variable">digit</span>|
        <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">buttons</span>[digit].<span class="Entity">on_action</span> { <span class="Entity">press</span>(digit) }
      <span class="Keyword">end</span>
      <span class="String"><span class="String">%w(</span>+ - * /<span class="String">)</span></span>.<span class="Entity">each</span> <span class="Keyword">do </span>|<span class="Variable">operation</span>|
        <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">buttons</span>[operation].<span class="Entity">on_action</span> { <span class="Entity">operand</span>(operation) }
      <span class="Keyword">end</span>
      <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">buttons</span>[<span class="String"><span class="String">'</span>C<span class="String">'</span></span>].<span class="Entity">on_action</span> { clear }
      <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">buttons</span>[<span class="String"><span class="String">'</span>√<span class="String">'</span></span>].<span class="Entity">on_action</span> { sqrt }
      <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">buttons</span>[<span class="String"><span class="String">'</span>=<span class="String">'</span></span>].<span class="Entity">on_action</span> { evaluate }
    <span class="Keyword">end</span>
  <span class="Keyword">end</span>
  
<span class="Comment">  <span class="Comment">#</span>...</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; application.rb (refactored)</h1>
<div style="font-size: 80%">
<div class="UltraViolet"><pre class="twilight">  <span class="Keyword">def</span> <span class="Entity">evaluate</span>
    <span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">evaluate</span>
    <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">update_value</span>(<span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">current_value</span>)
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">press</span>(<span class="Variable">key</span>)
    <span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">press</span>(key)
    <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">update_value</span>(<span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">current_value</span>)
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">operand</span>(<span class="Variable">key</span>)
    <span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">operand</span>(key)
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">sqrt</span>
    <span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">sqrt</span>
    <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">update_value</span>(<span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">current_value</span>)
  <span class="Keyword">end</span>
  
  <span class="Keyword">def</span> <span class="Entity">clear</span>
    <span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">clear</span>
    <span class="Variable"><span class="Variable">@</span>view</span>.<span class="Entity">update_value</span>(<span class="Variable"><span class="Variable">@</span>model</span>.<span class="Entity">current_value</span>)
  <span class="Keyword">end</span>
</pre></div></div>
</div>

<div class="slide">
<h1>Calculator &#8211; Run Unit Tests</h1>
<pre>
 
# DO THE DEMO
 
$ TESTOPTS="-v" rake test:units
 
</pre>
</div>

<div class="slide">
<h1>Summary</h1>
<ul>
	<li>Using Ruby with Cocoa is easier than you think</li>
	<li>Acceptance test with Accessibility API</li>
	<li>Unit test by separating in to MVC concerns</li>
</ul>
</div>

<div class="slide">
<h1>Questions?</h1>
</div>

<div class="slide">
<h1>Resources / Links</h1>
<ul>
	<li>http://rubycocoa.com/</li>
	<li>http://macruby.com/</li>
	<li>http://developer.apple.com/cocoa/</li>
	<li>/Developer/Examples/Ruby</li>
</ul></div>


</div>

</body>
</html>
